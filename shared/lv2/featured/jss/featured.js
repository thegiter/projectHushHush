function lv2FtdModule(t,e){this.id=t;var i=shpsCmm.iCMgr;this.teo=new ttlElmOnload(t),Promise.all([i.getObjUrl("/homepage/imgs/bg_img.jpg","img"),i.getObjUrl("/homepage/csss/hp.css","link")]).then(function(t){teoCnr.addImgs(t[0].objUrl,[""]),teoCnr.addCss(t[1].objUrl),teoCnr.useDefault=!1,teoCnr.start()},function(){console.log("get lv2 ftd imgs error, does not exist in indexed db.")}),this.teo.addImgs("/shared/lv2/featured/imgs//*replace*/",["ptn.jpg","bg/caption_bd_sdw.jpg","bg/caption_hd.png","bg/ttl_ass.png","bg/ttl_bd_sdw.jpg"]),this.teo.start(),this.gen_ftdCtt=function(t,e,i,n,d,o,s,r){if(e<this.ttlWdt){var a=this.ttlWdt/e;e*=a,i*=a}if(i<this.ttlHgt){var a=this.ttlHgt/i;e*=a,i*=a}var l=this.ttlWdt,m=l,g;if(d){if(g="txt","undefined"==typeof o||"lft"!=o){var c=["lft","ctr","rgt"];o=c[getRandomInt(0,3)]}if("ctr"==o){var h=this.ttlWdt-2*this.img_wdt_min;("undefined"==typeof s||s>h)&&(s=getRandomInt(img_wdt_min,h+1)),this.img_wdt_max-=s}else("undefined"==typeof s||s>this.img_wdt_max)&&(s=getRandomInt(this.img_wdt_min,this.img_wdt_max+1)),this.img_wdt_max=this.ttlWdt-s;m=this.ttlWdt-s}else{var _=["even","random"];g=_[getRandomInt(0,2)]}for(var f=[],u=0,p=0,v=Math.round(i/2),b=Math.round(e/2),w="";l;){var x="img";switch(g){case"txt":switch(o){case"lft":0===u&&(x="txt");break;case"ctr":1==u&&(x="txt");break;case"rgt":l<s+this.img_wdt_min&&(x="txt")}break;case"even":x="img";break;case"random":x="img"}var k="";switch(x){case"img":f[u]=getRandomInt(this.img_wdt_min,this.img_wdt_max+1),m-f[u]<this.img_wdt_min&&(f[u]=m);for(var M=this.ctr_lft-p,C=b-M,F=0,j=[],H=this.ttlHgt;H>=this.block_hgt_min;){var W;if(0===F){var y;y=f[u]>=2*this.img_wdt_min?.1*this.ttlHgt:this.ttlHgt-this.block_hgt_min,W=getRandomInt(0,y+1),H-=W}else W+=j[F-1].hgt;var I=getRandomInt(this.block_hgt_min,this.ttlHgt-W);H-=I;var O=this.ctr_top-W,R=v-O,P=i/I*100;C=-C/(f[u]-e)*100,R=-R/(I-i)*100,k+='\r\n						<div class="ftd-ctt-block" style="top:'+W+"px;height:"+I+'px;">\r\n							<div class="ftd-ctt-img-cnr">\r\n								<a href="'+n+'" title="Open the portfolio article page." target="_blank" class="ftd-ctt-img" style="background-image:url('+t+");background-position:"+C+"% "+R+"%;background-size:auto "+P+'%">\r\n									'+lv2FtdModule.contour_html+"\r\n								</a>\r\n							</div>\r\n						</div>",j[F]={top:W,hgt:I},F++}m-=f[u];break;case"txt":f[u]=s,k=r}w+='<div class="ftd-ctt-col" style="width:'+f[u]+'px">	<!-- col stands for column -->'+k+"\r\n			</div>",l-=f[u],p+=f[u],u++}return w};var n=this;shpsCmm.createAjax("POST",e,shpsCmm.getRefererParam()+"&refpg="+window.location.hash,"json").then(function(t){function e(){function t(){n.cnr=document.getElementById(n.id);var t=n.cnr.getElementsByClassName("ftd-ctt-cnr")[0];n.ttlWdt=t.offsetWidth,n.ttlHgt=t.offsetHeight,n.block_hgt_min=Math.round(n.ttlHgt/3),n.img_wdt_min=Math.round(n.ttlWdt/6),n.img_wdt_max=n.ttlWdt-n.img_wdt_min,n.ctr_top=Math.round(n.ttlHgt/2),n.ctr_lft=Math.round(n.ttlWdt/2);var e=t.children[0];e.innerHTML=n.gen_ftdCtt(i[0].img_url,i[0].img_wdt,i[0].img_hgt,i[0].item_link,i[0].txt,i[0].txt_pstn,i[0].txt_wdt,i[0].txt_html),n.cnr.classList.remove("opa-0")}n.teo.lded?t():n.teo.callback=t}var i=t.response;"Array"==classOf(i)&&(i.forEach(function(t){imgPreload(t.img_url)}),lv2FtdModule.modLded?e():lv2FtdModule.modOnloadFcts.push(e))})}lv2FtdModule.modOnloadFcts=[],function(){function t(){"undefined"!=typeof lv2FtdModule.contour_html&&(lv2FtdModule.modLded=!0,lv2FtdModule.modOnloadFcts.forEach(function(t){t()}))}shpsCmm.createAjax("POST","/shared/contour/contour.php",shpsCmm.getRefererParam()).then(function(e){lv2FtdModule.contour_html='<div class="contour-wpr">\r\n			'+e.responseText+"\r\n		</div>",t()})}();