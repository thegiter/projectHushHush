"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var _extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();!function(){var e="hex_grid",t=30,n=120,r=0,s=2,a=1,o=1,l=5,i=25,u="play",c="/shared/modules/js_frameworks/anim/",_=shpsCmm.moduleMgr,m=shpsCmm.domMgr,h=shpsCmm.util;_.hooks[e]=function(e){var u=e.obj={},d=function(e){function t(e){_classCallCheck(this,t);var n=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n._setElm=n._setElm.bind(n),n}return _inherits(t,e),_createClass(t,[{key:"_setElm",value:function n(e){this._elm=e}}]),_createClass(t,[{key:"getElm",value:function r(){return this._elm}},{key:"render",value:function s(){return React.createElement("div",{className:"hex-h hex-wdt-pusher",ref:this._setElm},React.createElement("div",{className:"hex-hgt-pusher"},React.createElement("div",{className:"hex"})))}}]),t}(React.Component),f=function(e){function t(e){_classCallCheck(this,t);var n=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));n._setElm=n._setElm.bind(n),n._hexes=[];for(var r=0;r<n.props.numCols;r++)n._hexes.push(React.createElement(d,null));return n}return _inherits(t,e),_createClass(t,[{key:"_setElm",value:function n(e){this._elm=e}}]),_createClass(t,[{key:"getElm",value:function r(){return this._elm}},{key:"render",value:function s(){return React.createElement("div",{className:"hex-r",ref:this._setElm},this._hexes)}}]),t}(React.Component),p=function(e){function t(e){_classCallCheck(this,t);var n=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n._setElm=n._setElm.bind(n),n}return _inherits(t,e),_createClass(t,[{key:"_setElm",value:function n(e){this._elm=e}}]),_createClass(t,[{key:"getElm",value:function r(){return this._elm}},{key:"render",value:function s(){return React.createElement("div",{className:"hex hex-v",ref:this._setElm},React.createElement("div",null))}}]),t}(React.Component),y=function(e){function t(e){_classCallCheck(this,t);var n=_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));n._setElm=n._setElm.bind(n),n._hexes=[];for(var r=0;r<n.props.numRows;r++)n._hexes.push(React.createElement(p,null));return n}return _inherits(t,e),_createClass(t,[{key:"_setElm",value:function n(e){this._elm=e}}]),_createClass(t,[{key:"getElm",value:function r(){return this._elm}},{key:"render",value:function s(){return React.createElement("div",{className:"hex-c",ref:this._setElm},this._hexes)}}]),t}(React.Component),v=function(e){function u(e){_classCallCheck(this,u);var t=_possibleConstructorReturn(this,(u.__proto__||Object.getPrototypeOf(u)).call(this,e));return t._setElm=t._setElm.bind(t),t._rmvPopSdw=t._rmvPopSdw.bind(t),t._delayedPlay=t._delayedPlay.bind(t),t.enable=t.enable.bind(t),t.disable=t.disable.bind(t),t.state={numRows:t.props.numRows,numCols:t.props.numCols,delay_min:t.props.delay_min,delay_max:t.props.delay_max},t._pop=!t.props.noPop,t.props.ver?(t._createGrid=function(){for(var e=0;e<t.state.numCols;e++)t._grid.push(React.createElement(y,{numRows:t.state.numRows}))},t._getHexes=function(){return t._elm.getElementsByClassName("hex-v")}):(t._createGrid=function(){for(var e=0;e<t.state.numRows;e++)t._grid.push(React.createElement(f,{numCols:t.state.numCols}))},t._getHexes=function(){return t._elm.getElementsByClassName("hex-h")}),_.get(c).then(function(e){t._trans=new e.obj.Trans(function(e){var n=e*(e-75)/25,r=e*(e-50)/19,s=e*(e-2)/24,a=e*(e-2)/22,o=21*e;t._elm.style.backgroundImage="radial-gradient(farthest-corner, hsla(186, 87%, 40%, 0) "+n+"%, hsla(186, 87%, 5%, .5) "+r+"%, hsl(186, 87%, 80%) "+s+"%, hsla(186, 87%, 40%, .2) "+a+"%, hsla(186, 87%, 40%, 0) "+o+"%)"},0,100,5e3,"qrtEaseIn"),t._trans.addEvtLsnr("end",t._delayedPlay),t._pop&&t._trans.addEvtLsnr("end",t._rmvPopSdw)}),t}return _inherits(u,e),_createClass(u,[{key:"_setElm",value:function d(e){this._elm=e}},{key:"_rmvPopSdw",value:function p(){this._popHexes.forEach(function(e){e.style.removeProperty("filter")})}},{key:"_delayedPlay",value:function v(){var e=this;this._enabled&&(this._toId=setTimeout(function(){if(!e._trans||"none"==m.getStyle(e._elm,"display"))return e._delayedPlay(),!1;if(e._pop){var t=[];Array.from(e._getHexes()).forEach(function(n){m.isInVp(n)&&m.isInParentBound(n,e._elm)&&t.push(n)});var n=(s-a-r)/t.length,u=r;e._popHexes=[],t.forEach(function(t){h.getRandomInt(0,100)<i&&(e._popHexes.push(t),setTimeout(function(){t.style.filter="drop-shadow(0 0 "+h.getRandomInt(o,l+1)+"px rgba(0, 0, 0, .75))"},h.getRandomInt(1e3*u,1e3*s))),u+=n}),setTimeout(e._trans.play,1e3*(s-a))}else e._trans.play()},h.getRandomInt(1e3*this.state.delay_min,1e3*this.state.delay_max)))}}],[{key:"defaultProps",get:function b(){return{delay_min:t,delay_max:n}}}]),_createClass(u,[{key:"getElm",value:function E(){return this._elm}},{key:"setNumCols",value:function C(e){this.setState({numCols:e})}},{key:"setNumRows",value:function g(e){this.setState({numRows:e})}},{key:"setDelay",value:function R(e,t){var n={};(e||0===e)&&(n.delay_min=e),(t||0===t)&&(n.delay_max=t),this.setState(n)}},{key:"disablePop",value:function k(){this._pop=!1,this._trans.rmvEvtLsnr("end",this._rmvPopSdw)}},{key:"enablePop",value:function x(){this._pop=!0,this._trans.addEventListener("end",this._rmvPopSdw)}},{key:"disable",value:function w(){this._enabled=!1,clearTimeout(this._toId)}},{key:"enable",value:function P(){this._enabled=!0,this._delayedPlay()}},{key:"render",value:function O(){return this._grid=[],this._createGrid(),React.createElement("div",{className:"hex-grid pos-abs-ful of-hid",ref:this._setElm},this._grid)}}]),u}(React.Component),b=u.hexGridFactory={};b.createObj=function(e){function t(e){n=e}var n=void 0;return ReactDOM.render(React.createElement(v,_extends({},e,{ref:t})),document.createElement("div")),n}}}();