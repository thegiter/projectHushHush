"use strict";function _classCallCheck(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function t(t,n){for(var s=0;s<n.length;s++){var i=n[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(n,s,i){return s&&t(n.prototype,s),i&&t(n,i),n}}();!function(){var t="data_mgr_fw",n=100,s=shpsCmm.moduleMgr,i=shpsCmm.util;s.hooks[t]=function(t){var s=t.obj={},a=function(){function t(n,s,i,a){var r=this;_classCallCheck(this,t),this.rowsCnr=n,this.getDataFct=s,this.dataType=i,this.additionalRowsCnrs=[],a&&(this.additionalRowsCnrs=a),this._frag=document.createDocumentFragment(),this._additionalFrags=[],a.forEach(function(){r._additionalFrags.push(document.createDocumentFragment())}),this._numDs=this._numDs.bind(this),this._numAs=this._numAs.bind(this),this._sort=this._sort.bind(this),this._applySort=this._applySort.bind(this),this.ascend=this.ascend.bind(this),this.descend=this.descend.bind(this)}return _createClass(t,[{key:"_createTmpArr",value:function s(){var t=this;this._tmpArr=Array.from(this.rowsCnr.children),this._tmpArr.forEach(function(t,n){t.dMSortOldIdx=n}),this._additionalCnrsTmpArr=[],this.additionalRowsCnrs.forEach(function(n){t._additionalCnrsTmpArr.push(Array.from(n.children))})}},{key:"_numAs",value:function i(t,n){return this.getDataFct(t)-this.getDataFct(n)}},{key:"_numDs",value:function a(t,n){return this.getDataFct(n)-this.getDataFct(t)}},{key:"_sortTmpArr",value:function r(t){this._tmpArr.sort(t)}},{key:"_applyRows",value:function e(t,s){var i=this,a=t+n,r=this._tmpArr;a>r.length&&(a=r.length),s=s.then(function(){for(var n=function e(t){i.rowsCnr.appendChild(r[t]),i.additionalRowsCnrs.forEach(function(n,s){n.appendChild(i._additionalCnrsTmpArr[s][t])})},s=t;a>s;s++)n(s)}),r.length>a&&this._applyRows(a,s)}},{key:"_applySort",value:function o(){var t=this;this._tmpArr.forEach(function(n,s){t._frag.appendChild(n),t.additionalRowsCnrs.forEach(function(s,i){t._additionalFrags[i].appendChild(t._additionalCnrsTmpArr[i][n.dMSortOldIdx])})}),this.rowsCnr.appendChild(this._frag),this.additionalRowsCnrs.forEach(function(n,s){n.appendChild(t._additionalFrags[s])})}},{key:"_sort",value:function c(n){this._sorting||(this._sorting=!0,this._createTmpArr(),t._clearCnr(this.rowsCnr),this.additionalRowsCnrs.forEach(function(n){t._clearCnr(n)}),this._sortTmpArr(this["_"+this.dataType+n]),this._applySort())}}],[{key:"_clearCnr",value:function h(t){for(;t.firstChild;)t.removeChild(t.firstChild)}}]),_createClass(t,[{key:"ascend",value:function d(){this._sort("As")}},{key:"descend",value:function l(){this._sort("Ds")}}]),t}();s.Sort=a;var r=function(){function t(n,s,i){_classCallCheck(this,t),this.rowsCnr=n,this.getDataFct=s,this.additionalRowsCnrs=[],i&&(this.additionalRowsCnrs=i),this._typeArr=[],this.apply=this.apply.bind(this)}return _createClass(t,[{key:"_chkCNotMatch",value:function s(t,n,i){var a=this.getDataFct(t,i),r=n.getCFct(n.elm);if("not set"==r)return!1;var e=void 0;switch(n.cType){case"=":e=a==r?!1:!0;break;case">":e=a>r?!1:!0;break;case"<":e=r>a?!1:!0;break;case">=":e=a>=r?!1:!0;break;case"<=":e=r>=a?!1:!0;break;default:return!0}return"include"==n.fType?e:!e}},{key:"_applyRows",value:function a(t,s){var i=this,a=t+n,r=this.rowsCnr.children;a>r.length&&(a=r.length),s=s.then(function(){for(var n=function e(t){var n=r[t];i._typeArr.some(function(t,s){return i._chkCNotMatch(n,t,s)})?n.classList.contains("dsp-non")||(n.classList.add("dsp-non"),i.additionalRowsCnrs.forEach(function(n){n.children[t].classList.add("dsp-non")})):n.classList.contains("dsp-non")&&(n.classList.remove("dsp-non"),i.additionalRowsCnrs.forEach(function(n){n.children[t].classList.remove("dsp-non")}))},s=t;a>s;s++)n(s)}),r.length>a&&this._applyRows(a,s)}}]),_createClass(t,[{key:"addEvtLsnr",value:function r(t,n,s){switch(n){case"dropdown":t.addEventListener("change",s)}}},{key:"setCriterion",value:function e(t,n,s,i,a,r){var e=this;this._typeArr[i]={elm:t,getCFct:n,fType:a,cType:r},this.addEvtLsnr(t,s,function(t){e.apply()})}},{key:"apply",value:function o(){var t=new i.AnimFramePromise;this._applyRows(0,t)}}]),t}();s.Filter=r}}();