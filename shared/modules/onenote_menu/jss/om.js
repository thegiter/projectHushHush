"use strict";!function(){var s="onenote_menu",t="/shared/modules/scrl_ind/",e=shpsCmm.moduleMgr,n=shpsCmm.util;e.hooks[s]=function(s){var i=s.obj={},a=i.onenoteMenu=function(s,t){this.elm=s,this.cnr=s.children[0],this.maxH=t,this.updatePanes(),this.cvrs=[],this.states=[],this.scrolls=[];for(var e=0;e<this.numLvls;e++)this.cvrs[e]=this.panes[e].getElementsByClassName("cvr")[0],this.addCvrEvt(this.cvrs[e],e+1),this.states[e]="closed",this.addScrlInd(e+1);this.crtFocus=0};a.prototype.updatePanes=function(){this.panes=this.cnr.children,this.numLvls=this.panes.length},a.prototype.addCvrEvt=function(s,t){var e=this;s.addEventListener("click",function(){e.focus(t)},!1)},a.prototype.addScrlInd=function(s){var n=this;e.get(t).then(function(t){var e=n.scrolls[s-1]=t.obj.scrlIndFactory.createObj({ver:!0}),i=n.panes[s-1];i.appendChild(e.getElm()),e.enableVer(i.children[0])})},a.prototype.initScrlInd=function(s){var n=this;e.get(t).then(function(){n.scrolls[s-1].initVer()})},a.prototype.appendPane=function(s){var t=document.createElement("div"),e=document.createElement("div");e.classList.add("pane-bd","pane-bd-trans","closed","of-hid","dsp-non"),s&&e.appendChild(s),t.appendChild(e);var n=document.createElement("div");n.classList.add("cvr","dsp-non"),this.cvrs[this.numLvls]=n,this.addCvrEvt(n,this.numLvls+1),this.states[this.numLvls]="closed",t.appendChild(n),this.cnr.appendChild(t),this.updatePanes(),this.addScrlInd(this.numLvls)},a.prototype.addToPane=function(s,t){if(s>this.numLvls)for(var e=s-this.numLvls,n=1;e>=n;n++)this.appendPane();this.panes[s-1].children[0].appendChild(t)},a.prototype.open=function(s){var t=this;this.states[s-1]="opening";var e=this.panes[s-1].children[0],i=e.cloneNode(!0);i.style.width="auto",i.classList.add("vsb-hid","pos-abs"),i.classList.remove("dsp-non"),e.parentNode.appendChild(i);var a=i.offsetWidth;e.parentNode.removeChild(i);var o=function d(){"opening"==t.states[s-1]&&(e.style.width="auto",e.classList.add("of-auto"),e.classList.remove("of-hid"),t.states[s-1]="open",t.initScrlInd(s))};e.classList.remove("pane-bd-trans"),new n.AnimFramePromise(function(){e.style.maxHeight=e.parentNode.offsetHeight+"px"}).then(function(){e.classList.add("pane-bd-trans"),e.classList.remove("dsp-non")}).then(function(){e.offsetWidth!=a?(e.addEventListener("transitionend",function s(t){"width"==t.propertyName&&(t.target.removeEventListener(t.type,s),o())},!1),e.style.width=a+"px"):o(),e.style.maxHeight=t.maxH})},a.prototype.close=function(s){var t=this;this.states[s-1]="closing";var e=this.panes[s-1].children[0];new n.AnimFramePromise(function(){if("auto"==e.style.width){e.classList.add("of-hid"),e.classList.remove("of-auto");var i=e.cloneNode(!0);i.classList.add("vsb-hid","pos-abs"),e.parentNode.appendChild(i),e.style.width=i.offsetWidth+"px",e.parentNode.removeChild(i)}var a=function o(i){if("width"==i.propertyName&&(i.target.removeEventListener(i.type,o),"closing"==t.states[s-1])){var a=t.panes[s-2].children[0];new n.AnimFramePromise(function(){a.classList.remove("pane-bd-trans"),a.style.minHeight=a.parentNode.offsetHeight+"px"}).then(function(){a.classList.add("pane-bd-trans"),e.classList.add("dsp-non"),a.style.minHeight="0"}),t.states[s-1]="closed"}};e.addEventListener("transitionend",a,!1)}).then(function(){e.style.width="0"})},a.prototype.focus=function(s){if(this.crtFocus>s)for(var t=this.numLvls;t>s;t--)this.close(t),t>1&&this.cvrs[t-2].classList.add("dsp-non");else if(this.crtFocus<s)for(var e=this.crtFocus+1;s>=e;e++)this.open(e),e>1&&this.cvrs[e-2].classList.remove("dsp-non");this.crtFocus>0&&(this.panes[this.crtFocus-1].classList.add("omc-unfocused"),this.panes[this.crtFocus-1].classList.remove("omc-focused")),s>0&&(this.panes[s-1].classList.add("omc-focused"),this.panes[s-1].classList.remove("omc-unfocused")),this.crtFocus=s}}}();