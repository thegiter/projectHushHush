"use strict";!function(){var t="onenote_menu",e="/shared/modules/scrl_ind/",s=shpsCmm.moduleMgr;s.hooks[t]=function(t){var n=t.obj={},i=n.onenoteMenu=function(t,e){this.elm=t,this.cnr=t.children[0],this.maxH=e,this.updatePanes(),this.cvrs=[],this.states=[],this.scrolls=[];for(var s=0;s<this.numLvls;s++)this.cvrs[s]=this.panes[s].getElementsByClassName("cvr")[0],this.addCvrEvt(this.cvrs[s],s+1),this.states[s]="closed",this.addScrlInd(s+1);this.crtFocus=0};i.prototype.updatePanes=function(){this.panes=this.cnr.children,this.numLvls=this.panes.length},i.prototype.addCvrEvt=function(t,e){var s=this;t.addEventListener("click",function(){s.focus(e)},!1)},i.prototype.addScrlInd=function(t){var n=this;s.get(e).then(function(e){var s=n.scrolls[t-1]=e.obj.scrlIndFactory.createObj({ver:!0}),i=n.panes[t-1];i.appendChild(s.getElm()),s.enableVer(i.children[0])})},i.prototype.initScrlInd=function(t){var n=this;s.get(e).then(function(){n.scrolls[t-1].initVer()})},i.prototype.appendPane=function(t){var e=document.createElement("div"),s=document.createElement("div");mdf_cls(s,"add","pane-bd pane-bd-trans closed of-hid dsp-non"),t&&s.appendChild(t),e.appendChild(s);var n=document.createElement("div");mdf_cls(n,"add","cvr dsp-non"),this.cvrs[this.numLvls]=n,this.addCvrEvt(n,this.numLvls+1),this.states[this.numLvls]="closed",e.appendChild(n),this.cnr.appendChild(e),this.updatePanes(),this.addScrlInd(this.numLvls)},i.prototype.addToPane=function(t,e){if(t>this.numLvls)for(var s=t-this.numLvls,n=1;s>=n;n++)this.appendPane();this.panes[t-1].children[0].appendChild(e)},i.prototype.open=function(t){var e=this;this.states[t-1]="opening";var s=this.panes[t-1].children[0],n=s.cloneNode(!0);n.style.width="auto",mdf_cls(n,"add","vsb-hid pos-abs"),mdf_cls(n,"remove","dsp-non"),s.parentNode.appendChild(n);var i=n.offsetWidth;s.parentNode.removeChild(n);var d=function o(){"opening"==e.states[t-1]&&(s.style.width="auto",mdf_cls(s,"add","of-auto"),mdf_cls(s,"remove","of-hid"),e.states[t-1]="open",e.initScrlInd(t))};mdf_cls(s,"remove","pane-bd-trans"),requestAnimationFrame(function(){s.style.maxHeight=s.parentNode.offsetHeight+"px",requestAnimationFrame(function(){mdf_cls(s,"add","pane-bd-trans"),mdf_cls(s,"remove","dsp-non"),s.offsetWidth!=i?(s.addEventListener("transitionend",function t(e){"width"==e.propertyName&&(e.target.removeEventListener(e.type,t),d())},!1),requestAnimationFrame(function(){s.style.width=i+"px"})):d(),requestAnimationFrame(function(){s.style.maxHeight=e.maxH})})})},i.prototype.close=function(t){var e=this;this.states[t-1]="closing";var s=this.panes[t-1].children[0];requestAnimationFrame(function(){if("auto"==s.style.width){mdf_cls(s,"add","of-hid"),mdf_cls(s,"remove","of-auto");var n=s.cloneNode(!0);mdf_cls(n,"add","vsb-hid pos-abs"),s.parentNode.appendChild(n),s.style.width=n.offsetWidth+"px",s.parentNode.removeChild(n)}var i=e;s.addEventListener("transitionend",function d(e){if("width"==e.propertyName&&(e.target.removeEventListener(e.type,d),"closing"==i.states[t-1])){var n=i.panes[t-2].children[0];requestAnimationFrame(function(){mdf_cls(n,"remove","pane-bd-trans"),n.style.minHeight=n.parentNode.offsetHeight+"px",requestAnimationFrame(function(){mdf_cls(n,"add","pane-bd-trans"),mdf_cls(s,"add","dsp-non"),n.style.minHeight="0"})}),i.states[t-1]="closed"}},!1),requestAnimationFrame(function(){s.style.width="0"})})},i.prototype.focus=function(t){if(this.crtFocus>t)for(var e=this.numLvls;e>t;e--)this.close(e),e>1&&mdf_cls(this.cvrs[e-2],"add","dsp-non");else if(this.crtFocus<t)for(var s=this.crtFocus+1;t>=s;s++)this.open(s),s>1&&mdf_cls(this.cvrs[s-2],"remove","dsp-non");this.crtFocus>0&&(mdf_cls(this.panes[this.crtFocus-1],"add","omc-unfocused"),mdf_cls(this.panes[this.crtFocus-1],"remove","omc-focused")),t>0&&(mdf_cls(this.panes[t-1],"add","omc-focused"),mdf_cls(this.panes[t-1],"remove","omc-unfocused")),this.crtFocus=t}}}();