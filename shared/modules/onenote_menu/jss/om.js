!function(){const t="onenote_menu",e="/shared/modules/scrl_ind/";var s=shpsCmm.moduleMgr;s.hooks[t]=function(t){var n=t.obj={},d=n.onenoteMenu=function(t,e){this.elm=t,this.cnr=t.children[0],this.maxH=e,this.updatePanes(),this.cvrs=[],this.states=[],this.scrolls=[];for(var s=0;s<this.numLvls;s++)this.cvrs[s]=this.panes[s].getElementsByClassName("cvr")[0],this.addCvrEvt(this.cvrs[s],s+1),this.states[s]="closed",this.addScrlInd(s+1);this.crtFocus=0};d.prototype.updatePanes=function(){this.panes=this.cnr.children,this.numLvls=this.panes.length},d.prototype.addCvrEvt=function(t,e){var s=this;t.addEventListener("click",function(){s.focus(e)},!1)},d.prototype.addScrlInd=function(t){var n=this;s.get(e).then(function(e){var s=e.obj.scrlInd;n.scrolls[t-1]=new s(n.panes[t-1].children[0]),n.scrolls[t-1].activateVer()})},d.prototype.initScrlInd=function(t){var n=this;s.get(e).then(function(){n.scrolls[t-1].onScrollVer()})},d.prototype.appendPane=function(t){var e=document.createElement("div"),s=document.createElement("div");mdf_cls(s,"add","pane-bd pane-bd-trans closed of-hid dsp-non"),t&&s.appendChild(t),e.appendChild(s);var n=document.createElement("div");mdf_cls(n,"add","cvr dsp-non"),this.cvrs[this.numLvls]=n,this.addCvrEvt(n,this.numLvls+1),this.states[this.numLvls]="closed",e.appendChild(n),this.cnr.appendChild(e),this.updatePanes(),this.addScrlInd(this.numLvls)},d.prototype.addToPane=function(t,e){if(t>this.numLvls){var s=t-this.numLvls;for(i=1;i<=s;i++)this.appendPane()}this.panes[t-1].children[0].appendChild(e)},d.prototype.open=function(t){function e(){"opening"==d.states[t-1]&&(s.style.width="auto",mdf_cls(s,"add","of-auto"),mdf_cls(s,"remove","of-hid"),d.states[t-1]="open",d.initScrlInd(t))}this.states[t-1]="opening";var s=this.panes[t-1].children[0],n=s.cloneNode(!0);n.style.width="auto",mdf_cls(n,"add","vsb-hid pos-abs"),mdf_cls(n,"remove","dsp-non"),s.parentNode.appendChild(n);var i=n.offsetWidth;s.parentNode.removeChild(n);var d=this;mdf_cls(s,"remove","pane-bd-trans"),s.offsetHeight,s.style.maxHeight=s.parentNode.offsetHeight+"px",s.offsetHeight,mdf_cls(s,"add","pane-bd-trans"),mdf_cls(s,"remove","dsp-non"),s.offsetWidth!=i?(s.addEventListener("transitionend",function(t){"width"==t.propertyName&&(t.target.removeEventListener(t.type,arguments.callee),e())},!1),s.offsetHeight,s.style.width=i+"px"):e(),s.offsetHeight,s.style.maxHeight=this.maxH},d.prototype.close=function(t){this.states[t-1]="closing";var e=this.panes[t-1].children[0];if("auto"==e.style.width){mdf_cls(e,"add","of-hid"),mdf_cls(e,"remove","of-auto");var s=e.cloneNode(!0);mdf_cls(s,"add","vsb-hid pos-abs"),e.parentNode.appendChild(s),e.style.width=s.offsetWidth+"px",e.parentNode.removeChild(s),e.offsetWidth}var n=this;e.addEventListener("transitionend",function(s){if("width"==s.propertyName&&(s.target.removeEventListener(s.type,arguments.callee),"closing"==n.states[t-1])){var i=n.panes[t-2].children[0];mdf_cls(i,"remove","pane-bd-trans"),i.offsetHeight,i.style.minHeight=i.parentNode.offsetHeight+"px",i.offsetHeight,mdf_cls(i,"add","pane-bd-trans"),mdf_cls(e,"add","dsp-non"),e.offsetHeight,i.style.minHeight="0",n.states[t-1]="closed"}},!1),e.style.width="0"},d.prototype.focus=function(t){if(this.crtFocus>t)for(i=this.numLvls;i>t;i--)this.close(i),i>1&&mdf_cls(this.cvrs[i-2],"add","dsp-non");else if(this.crtFocus<t)for(i=this.crtFocus+1;i<=t;i++)this.open(i),i>1&&mdf_cls(this.cvrs[i-2],"remove","dsp-non");this.crtFocus>0&&(mdf_cls(this.panes[this.crtFocus-1],"add","omc-unfocused"),mdf_cls(this.panes[this.crtFocus-1],"remove","omc-focused")),t>0&&(mdf_cls(this.panes[t-1],"add","omc-focused"),mdf_cls(this.panes[t-1],"remove","omc-unfocused")),this.crtFocus=t}}}();