!function(){const t="lv2_featured",e="/shared/modules/contour/",i="ftd-ctt-img";var n=shpsCmm.moduleMgr;n.hooks[t]=function(t){var r=t.obj={},s=r.lv2Ftd=function(t,e,i,n){this.cnr=t,this.cttCnr=t.getElementsByClassName("ftd-ctt-cnr")[0];var r=this;this.ldedP=shpsCmm.createAjax("POST",e,shpsCmm.getRefererParam()+"&refpg="+window.location.hash,"json").then(function(t){var e=r.ftdCtt=t.response;if("Array"==classOf(e)){e.forEach(function(t){imgPreload(t.img_url)});var n=r.cnr;n.classList.remove("dsp-non"),n.offsetHeight;var s=new Promise(function(t,i){n.addEventListener("transitionend",function r(i){return i.target!=this?!1:(this.removeEventListener("transitionend",r),t(e),void 0)})});return n.style.height=i,s}throw new Error("ftd ctt ld failed")}).then(function(t){return r.createCtt(t[0],r.cttCnr)})};s.prototype.lded=function(){return this.ldedP},s.prototype.introBlks=function(){var t=this.cttCnr;t.classList.remove("vsb-hid"),requestAnimationFrame(function(){t.classList.remove("opa-0")})},s.prototype.createCtt=function(t,e){function n(){var t=a,n=d,r=e.offsetWidth,s=e.offsetHeight;t=r,n=t/j,s>n&&(n=s,t=n*j);var o=r/2,h=s/2,m=t/2,c=n/2;forEachNodeItem(g.children,function(e,r){var s=o-e.offsetLeft,a=s-m;forEachNodeItem(e.getElementsByClassName(i),function(e){var i=e.parentNode.parentNode,r=h-i.offsetTop,s=r-c,o=a/(e.offsetWidth-t)*100,d=s/(e.offsetHeight-n)*100,m=t/e.offsetWidth*100,f=n/e.offsetHeight*100;e.style.backgroundSize=m+"% "+f+"%",e.style.backgroundPosition=o+"% "+d+"%"})})}var r=s.getContour(),o=t.img_url,a=t.img_wdt,d=t.img_hgt,h=t.item_link,m=t.txt,c=t.txt_pstn,f=t.txt_wdt,l=t.txt_html,g=e.children[0];this.ttlWdt=e.offsetWidth,this.ttlHgt=e.offsetHeight,this.block_hgt_min=Math.round(this.ttlHgt/3),this.img_wdt_min=Math.round(this.ttlWdt/6),this.img_wdt_max=this.ttlWdt-this.img_wdt_min;var u=this.ttlWdt,_=u,v;if(m){if(v="txt","undefined"==typeof c||"lft"!=c){var p=["lft","ctr","rgt"];c=p[getRandomInt(0,3)]}if("ctr"==c){var w=this.ttlWdt-2*this.img_wdt_min;("undefined"==typeof f||f>w)&&(f=getRandomInt(img_wdt_min,w+1)),this.img_wdt_max-=f}else("undefined"==typeof f||f>this.img_wdt_max)&&(f=getRandomInt(this.img_wdt_min,this.img_wdt_max+1)),this.img_wdt_max=this.ttlWdt-f;_=this.ttlWdt-f}else{var x=["even","random"];v=x[getRandomInt(0,2)]}for(var H=[],k=0,y=0,b=[];u;){var C="img";switch(v){case"txt":switch(c){case"lft":0===k&&(C="txt");break;case"ctr":1==k&&(C="txt");break;case"rgt":u<f+this.img_wdt_min&&(C="txt")}break;case"even":C="img";break;case"random":C="img"}var E="";switch(C){case"img":H[k]=getRandomInt(this.img_wdt_min,this.img_wdt_max+1),_-H[k]<this.img_wdt_min&&(H[k]=_);for(var L=0,W=[],I=this.ttlHgt;I>=this.block_hgt_min;){var P;if(0===L){var R;R=H[k]>=2*this.img_wdt_min?.1*this.ttlHgt:this.ttlHgt-this.block_hgt_min,P=getRandomInt(0,R+1),I-=P}else P+=W[L-1].hgt;var N=getRandomInt(this.block_hgt_min,this.ttlHgt-P);I-=N;var M=N/this.ttlHgt*100,T=P/this.ttlHgt*100;E+='\r\n							<div class="ftd-ctt-block" style="top:'+T+"%;height:"+M+'%;">\r\n								<div class="ftd-ctt-img-cnr">\r\n									<a href="'+h+'" title="Open the featured article page." class="ftd-ctt-img" style="background-image:url('+o+');">\r\n									</a>\r\n								</div>\r\n							</div>',W[L]={top:P,hgt:N},L++}_-=H[k];break;case"txt":H[k]=f,E=txtHTML}b.push('<div class="ftd-ctt-col" style="width:'+H[k]+'px"><!--col stands for column-->'+E+"\r\n				</div>"),u-=H[k],y+=H[k],k++}g.innerHTML=b.join(""),r.then(function(t){forEachNodeItem(g.getElementsByClassName(i),function(e){e.innerHTML=t,requestAnimationFrame(function(){e.children[0].classList.remove("opa-0")})})});var j=a/d;return shpsCmm.optElmRszLsnr.add(e,n)},s.getContour=function(){return this.contourP?this.contourP:this.contourP=n.get(e).then(function(t){return s.contourHtml='<div class="contour-wpr opa-0 fade-in-norm">\r\n					'+t.html+"\r\n				</div>",s.contourHtml})}}}();