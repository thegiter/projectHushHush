!function(){const t="lv2_featured",i="/shared/modules/contour/",e="ftd-ctt-img";var n=shpsCmm.moduleMgr;n.hooks[t]=function(t){var s=t.obj={},r=s.lv2Ftd=function(t,i,e,n){this.cnr=t,this.cttCnr=t.getElementsByClassName("ftd-ctt-cnr")[0];var s=this;shpsCmm.createAjax("POST",i,shpsCmm.getRefererParam()+"&refpg="+window.location.hash,"json").then(function(t){var i=s.ftdCtt=t.response;if("Array"==classOf(i)){i.forEach(function(t){imgPreload(t.img_url)});var n=s.cnr;n.classList.remove("dsp-non"),n.offsetHeight,n.addEventListener("transitionend",function r(t){return t.target!=this?!1:(this.removeEventListener("transitionend",r),s.createCtt(i[0],s.cttCnr),s.cttCnr.classList.remove("opa-0"),void 0)}),n.style.height=e}})};r.prototype.createCtt=function(t,i){var n=r.getContour(),s=t.img_url,o=t.img_wdt,a=t.img_hgt,h=t.item_link,d=t.txt,m=t.txt_pstn,c=t.txt_wdt,l=t.txt_html,g=i.children[0];if(this.ttlWdt=i.offsetWidth,this.ttlHgt=i.offsetHeight,this.block_hgt_min=Math.round(this.ttlHgt/3),this.img_wdt_min=Math.round(this.ttlWdt/6),this.img_wdt_max=this.ttlWdt-this.img_wdt_min,this.ctr_top=this.ttlHgt/2,this.ctr_lft=this.ttlWdt/2,o<this.ttlWdt){var f=this.ttlWdt/o;o*=f,a*=f}if(a<this.ttlHgt){var f=this.ttlHgt/a;o*=f,a*=f}var _=this.ttlWdt,u=_,v;if(d){if(v="txt","undefined"==typeof m||"lft"!=m){var p=["lft","ctr","rgt"];m=p[getRandomInt(0,3)]}if("ctr"==m){var w=this.ttlWdt-2*this.img_wdt_min;("undefined"==typeof c||c>w)&&(c=getRandomInt(img_wdt_min,w+1)),this.img_wdt_max-=c}else("undefined"==typeof c||c>this.img_wdt_max)&&(c=getRandomInt(this.img_wdt_min,this.img_wdt_max+1)),this.img_wdt_max=this.ttlWdt-c;u=this.ttlWdt-c}else{var H=["even","random"];v=H[getRandomInt(0,2)]}for(var x=[],k=0,b=0,y=a/2,C=o/2,W=[];_;){var I="img";switch(v){case"txt":switch(m){case"lft":0===k&&(I="txt");break;case"ctr":1==k&&(I="txt");break;case"rgt":_<c+this.img_wdt_min&&(I="txt")}break;case"even":I="img";break;case"random":I="img"}var E="";switch(I){case"img":x[k]=getRandomInt(this.img_wdt_min,this.img_wdt_max+1),u-x[k]<this.img_wdt_min&&(x[k]=u);for(var L=0,N=[],R=this.ttlHgt;R>=this.block_hgt_min;){var P;if(0===L){var M;M=x[k]>=2*this.img_wdt_min?.1*this.ttlHgt:this.ttlHgt-this.block_hgt_min,P=getRandomInt(0,M+1),R-=P}else P+=N[L-1].hgt;var T=getRandomInt(this.block_hgt_min,this.ttlHgt-P);R-=T;var j=T/this.ttlHgt*100,B=P/this.ttlHgt*100;E+='\r\n							<div class="ftd-ctt-block" style="top:'+B+"%;height:"+j+'%;">\r\n								<div class="ftd-ctt-img-cnr">\r\n									<a href="'+h+'" title="Open the featured article page." target="_blank" class="ftd-ctt-img" style="background-image:url('+s+');">\r\n									</a>\r\n								</div>\r\n							</div>',N[L]={top:P,hgt:T},L++}u-=x[k];break;case"txt":x[k]=c,E=txtHTML}W.push('<div class="ftd-ctt-col" style="width:'+x[k]+'px"><!--col stands for column-->'+E+"\r\n				</div>"),_-=x[k],b+=x[k],k++}g.innerHTML=W.join(""),n.then(function(t){forEachNodeItem(g.getElementsByClassName(e),function(i){i.innerHTML=t,i.children[0].classList.remove("opa-0")})});var O=this;forEachNodeItem(g.children,function(t,i){var n=O.ctr_lft-t.offsetLeft,s=n-C;forEachNodeItem(t.getElementsByClassName(e),function(t){var i=t.parentNode.parentNode,e=O.ctr_top-i.offsetTop,n=e-y,r=s/(t.offsetWidth-o)*100,h=n/(t.offsetHeight-a)*100,d=a/t.offsetHeight*100,m=o/t.offsetWidth*100;t.style.backgroundSize=m+"% "+d+"%",t.style.backgroundPosition=r+"% "+h+"%"})})},r.getContour=function(){return this.contourP?this.contourP:this.contourP=n.get(i).then(function(t){return r.contourHtml='<div class="contour-wpr opa-0 fade-in-norm">\r\n					'+t.html+"\r\n				</div>",r.contourHtml})}}}();