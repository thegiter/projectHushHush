!function(){const t="lv2_featured",i="/shared/modules/contour/",e="ftd-ctt-img";var n=shpsCmm.moduleMgr;n.hooks[t]=function(t){var s=t.obj={},r=s.lv2Ftd=function(t,i,e,n){this.cnr=t,this.cttCnr=t.getElementsByClassName("ftd-ctt-cnr")[0];var s=this;shpsCmm.createAjax("POST",i,shpsCmm.getRefererParam()+"&refpg="+window.location.hash,"json").then(function(t){var i=s.ftdCtt=t.response;if("Array"==classOf(i)){i.forEach(function(t){imgPreload(t.img_url)});var n=s.cnr;n.classList.remove("dsp-non"),n.offsetHeight,n.addEventListener("transitionend",function r(t){return t.target!=this?!1:(this.removeEventListener("transitionend",r),s.createCtt(i[0],s.cttCnr).then(function(){s.cttCnr.classList.remove("opa-0")}),void 0)}),n.style.height=e}})};r.prototype.createCtt=function(t,i){function n(){var t=a,n=h,s=i.offsetWidth,r=i.offsetHeight;t=s,n=t/j,r>n&&(n=r,t=n*j);var o=s/2,d=r/2,m=t/2,c=n/2;forEachNodeItem(l.children,function(i,s){var r=o-i.offsetLeft,a=r-m;forEachNodeItem(i.getElementsByClassName(e),function(i){var e=i.parentNode.parentNode,s=d-e.offsetTop,r=s-c,o=a/(i.offsetWidth-t)*100,h=r/(i.offsetHeight-n)*100,m=t/i.offsetWidth*100,f=n/i.offsetHeight*100;i.style.backgroundSize=m+"% "+f+"%",i.style.backgroundPosition=o+"% "+h+"%"})})}var s=r.getContour(),o=t.img_url,a=t.img_wdt,h=t.img_hgt,d=t.item_link,m=t.txt,c=t.txt_pstn,f=t.txt_wdt,g=t.txt_html,l=i.children[0];this.ttlWdt=i.offsetWidth,this.ttlHgt=i.offsetHeight,this.block_hgt_min=Math.round(this.ttlHgt/3),this.img_wdt_min=Math.round(this.ttlWdt/6),this.img_wdt_max=this.ttlWdt-this.img_wdt_min;var _=this.ttlWdt,u=_,v;if(m){if(v="txt","undefined"==typeof c||"lft"!=c){var p=["lft","ctr","rgt"];c=p[getRandomInt(0,3)]}if("ctr"==c){var w=this.ttlWdt-2*this.img_wdt_min;("undefined"==typeof f||f>w)&&(f=getRandomInt(img_wdt_min,w+1)),this.img_wdt_max-=f}else("undefined"==typeof f||f>this.img_wdt_max)&&(f=getRandomInt(this.img_wdt_min,this.img_wdt_max+1)),this.img_wdt_max=this.ttlWdt-f;u=this.ttlWdt-f}else{var x=["even","random"];v=x[getRandomInt(0,2)]}for(var H=[],k=0,b=0,C=[];_;){var y="img";switch(v){case"txt":switch(c){case"lft":0===k&&(y="txt");break;case"ctr":1==k&&(y="txt");break;case"rgt":_<f+this.img_wdt_min&&(y="txt")}break;case"even":y="img";break;case"random":y="img"}var W="";switch(y){case"img":H[k]=getRandomInt(this.img_wdt_min,this.img_wdt_max+1),u-H[k]<this.img_wdt_min&&(H[k]=u);for(var E=0,I=[],L=this.ttlHgt;L>=this.block_hgt_min;){var R;if(0===E){var N;N=H[k]>=2*this.img_wdt_min?.1*this.ttlHgt:this.ttlHgt-this.block_hgt_min,R=getRandomInt(0,N+1),L-=R}else R+=I[E-1].hgt;var P=getRandomInt(this.block_hgt_min,this.ttlHgt-R);L-=P;var M=P/this.ttlHgt*100,T=R/this.ttlHgt*100;W+='\r\n							<div class="ftd-ctt-block" style="top:'+T+"%;height:"+M+'%;">\r\n								<div class="ftd-ctt-img-cnr">\r\n									<a href="'+d+'" title="Open the featured article page." target="_blank" class="ftd-ctt-img" style="background-image:url('+o+');">\r\n									</a>\r\n								</div>\r\n							</div>',I[E]={top:R,hgt:P},E++}u-=H[k];break;case"txt":H[k]=f,W=txtHTML}C.push('<div class="ftd-ctt-col" style="width:'+H[k]+'px"><!--col stands for column-->'+W+"\r\n				</div>"),_-=H[k],b+=H[k],k++}l.innerHTML=C.join(""),s.then(function(t){forEachNodeItem(l.getElementsByClassName(e),function(i){i.innerHTML=t,requestAnimationFrame(function(){i.children[0].classList.remove("opa-0")})})});var j=a/h;return shpsCmm.optElmRszLsnr.add(i,n)},r.getContour=function(){return this.contourP?this.contourP:this.contourP=n.get(i).then(function(t){return r.contourHtml='<div class="contour-wpr opa-0 fade-in-norm">\r\n					'+t.html+"\r\n				</div>",r.contourHtml})}}}();