"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var _extends=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var s=arguments[e];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(t[n]=s[n])}return t},_createClass=function(){function t(t,e){for(var s=0;s<e.length;s++){var n=e[s];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,s,n){return s&&t(e.prototype,s),n&&t(e,n),e}}();!function(){var t="lv2_ctt_ldr",e="/shared/modules/ldg_signs/td_bars/",s="/shared/modules/ldg_signs/css_spiners/",n="/shared/modules/js_frameworks/iv_mgr/",r=4,a=100/r,i=100-a,o=["start","ctr","end"],l=shpsCmm.moduleMgr,c=shpsCmm.util,d=function f(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:c.getRandomInt(0,361),e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return"hsla("+t+", 96%, "+(34+e)+"%, "+(.3+s)+")"},m=void 0,u=void 0,_=void 0,h=l.get(e,!0).then(function(t){m=t.obj.ldgTdBarsFactory}),p=l.get(s,!0).then(function(t){u=t.obj.ldgCssSpinersFactory});l.get(n,!0).then(function(t){_=t.obj.ivMgr}),l.hooks[t]=function(t){var e=t.obj={},s={},n=function(t){function e(t){_classCallCheck(this,e);var n=_possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));n._setElm=n._setElm.bind(n),n.state={imgStyle:{},randZ:c.getRandomInt(100,201),blur:!0,translate:!0,opa:!0};var r=c.getRandomInt(0,361),l=d(r);n._lightColor=d(r,50),n._wprStyle={backgroundImage:"linear-gradient(to bottom right, "+l+" 0%, "+n._lightColor+" 50%, "+l+" 100%)"},n._txtStyle={};var m=n.props.item,u=m.img_url;n._imgLdedP=Promise.resolve();var _=m.txt,h=m.txt_html,p=m.txt_img,f=m.txt_wdt,g=m.txt_pstn;if(n._txtCtt="",n._txtCls="",_?(n._txtCtt=h,g?"lft"==g?g="start":"rgt"==g&&(g="end"):g=o[c.getRandomInt(0,3)],f||(f=c.getRandomInt(a,i+1)),n._txtStyle.flexBasis=f+"%"):m.img_cap&&(n._txtCtt=m.img_cap),n._imgCls="",u){var C=function v(t){return shpsCmm.imgLdr.imgLded(t).then(function(){return t})};n.props.cached&&(C=function b(t){return shpsCmm.iCMgr.getBlobUrl(t,"img")}),n._imgLdedP=s[u]?s[u]:s[u]=C(u),n._imgLdedP.then(function(t){n.setState({imgStyle:{backgroundImage:"url("+t+")"}})})}else n._imgCls="dsp-non";if(_||u)if(_)if(u)if(n._arCls="3-6",n._szeCls="",n._orientationCls="",p){switch(n._txtCls="pos-abs top-0 btm-0",g){case"start":n._txtCls+=" lft-0";break;case"ctr":n._txtStyle.left="50%",n._txtStyle.transform="translatex(-50%)";break;case"end":n._txtCls+=" rgt-0"}n._txtStyle.width=f+"%"}else n.state.imgStyle.backgroundPosition="left","start"==g&&(n._txtCls+=" lft-0",n.state.imgStyle.backgroundPosition="right");else switch(n._arCls="3-6",n._szeCls="",n._orientationCls="",.28125>f?n._orientationCls="portrait":9/16>f&&(n._arCls="3-3",n._szeCls=["","sml"][c.getRandomInt(0,2)]),g){case"start":case"end":n._wprStyle.justifyContent="flex-"+g;break;case"ctr":n._wprStyle.justifyContent="center"}else n._szeCls="",n._orientationCls="",n._txtCtt?(n._arCls=["3-3","3-6","3-9"][c.getRandomInt(0,3)],"3-6"==n._arCls&&(n._orientationCls="portrait")):n._arCls="3-6";else n._arCls="3-3",n._szeCls="",n._orientationCls=["portrait",""][c.getRandomInt(0,2)];return"3-3"==n._arCls&&(n._orientationCls="portrait"),n}return _inherits(e,t),_createClass(e,[{key:"_setElm",value:function n(t){this._elm=t,this._txtCnr=t.getElementsByClassName("txt-cnr")[0],this._imgCnr=t.getElementsByClassName("img-cnr")[0]}}],[{key:"defaultProps",get:function r(){return{clss:""}}}]),_createClass(e,[{key:"componentDidMount",value:function l(){var t=this;this._txtCtt&&(this._txtCnr.innerHTML=this._txtCtt),p.then(function(){t._imgLded||(t._ldgCs=u.createObj(),t._imgCnr.appendChild(t._ldgCs.getElm()))}),this._imgLdedP.then(function(){t._imgLded=!0,t._ldgCs&&t._ldgCs.rmv()})}},{key:"getElm",value:function m(){return this._elm}},{key:"rand",value:function _(){this.setState({randZ:c.getRandomInt(100,201),randX:c.getRandomInt(-50,50),randY:c.getRandomInt(-50,50)})}},{key:"focus",value:function h(){this.setState({blur:!1,translate:!1,opa:!1})}},{key:"blur",value:function f(){this.setState({blur:!0,translate:!0,opa:!0})}},{key:"render",value:function g(){var t="drop-shadow(-.5em -.5em .2em "+this._lightColor+")\n				drop-shadow(.5em -.5em .2em "+this._lightColor+")\n				drop-shadow(-.5em .5em .2em "+this._lightColor+")\n				drop-shadow(.5em .5em .2em "+this._lightColor+")";this.state.blur&&(t+=" blur("+((this.state.randZ-100)/100*.45+.05)+"vmax)");var e={filter:t};return this.state.translate&&(e.transform="translatez(-"+this.state.randZ+"vmax)",this.state.randX&&(e.transform+=" translatex("+this.state.randX+"%)"),this.state.randY&&(e.transform+=" translatey("+this.state.randY+"%)")),this.state.opa&&(e.opacity=1-this.state.randZ/200*.4),React.createElement("div",{className:"pos-rel psv-3d ar-"+this._arCls+" "+this._szeCls+" "+this._orientationCls+" "+this.props.clss,ref:this._setElm},React.createElement("div",{className:"pos-abs-ful"}),React.createElement("a",{href:this.props.item.item_link,className:"dsp-blk pos-abs-ful",style:e},React.createElement("div",{className:"pos-abs-ful dsp-flx",style:this._wprStyle},React.createElement("div",{className:"img-cnr pos-rel "+this._imgCls,style:this.state.imgStyle}),React.createElement("div",{className:"txt-cnr "+this._txtCls,style:this._txtStyle}))))}}]),e}(React.Component),r=function(t){function e(t){_classCallCheck(this,e);var s=_possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return s._setElm=s._setElm.bind(s),s._setObj=s._setObj.bind(s),s.play=s.play.bind(s),s.stop=s.stop.bind(s),s.state={items:[]},s.props.itemsUrl&&(s._itmsLdedP=shpsCmm.jsonLdr.lded(s.props.itemsUrl,"refpg="+window.location.hash,s.props.cached,"cttItemsList").then(function(t){if("Array"===c.classOf(t)){var e=[];return s._itmObjs=[],t.forEach(function(t){e.push(React.createElement(n,{item:t,cached:s.props.cached,ref:s._setObj}))}),s.setState({items:e}),s._itmsListLded=!0}throw new Error("ftd ctt ld failed")})),s}return _inherits(e,t),_createClass(e,[{key:"_setElm",value:function s(t){this._elm=t}},{key:"_setObj",value:function r(t){this._itmObjs.push(t)}}],[{key:"defaultProps",get:function a(){return{tag:"section",clss:""}}}]),_createClass(e,[{key:"componentDidMount",value:function i(){var t=this;this._itmsLdedP&&(h.then(function(){t._itmsListLded||(t._ldgTb=m.createObj(),t._elm.appendChild(t._ldgTb.getElm()))}),this._itmsLdedP.then(function(){t._ldgTb&&t._ldgTb.rmv(),t._itmObjs.forEach(function(e){var s=e.getElm().children[0];_.addEvtLsnr(s,"in",function(){e.focus()},{top:.3,btm:.3},t.props.scrlCnr),_.addEvtLsnr(s,"out",function(){e.blur()},{top:.3,btm:.3},t.props.scrlCnr)}),t._stopped||t.play()}))}},{key:"getElm",value:function o(){return this._elm}},{key:"play",value:function l(){var t=this;return this._itmsListLded?(this._stopped=!1,this._3dIvtId=setTimeout(function(){var e=t._itmObjs[c.getRandomInt(0,t._itmObjs.length)];e.rand(),t.play()},c.getRandomInt(250,1e4)),void 0):!1}},{key:"stop",value:function d(){this._3dIvtId&&(this._stopped=!0,clearInterval(this._3dIvtId),this._3dIvtId=void 0)}},{key:"render",value:function u(){return React.createElement(this.props.tag,{className:"lv2-cl-cnr pos-rel td-cnr "+this.props.clss,ref:this._setElm},React.createElement("div",{className:"lv2-cl-grid psv-3d"},React.createElement("div",null),this.state.items))}}]),e}(React.Component),l=e.lv2CttLdrFactory={};l.createObj=function(t){function e(t){s=t}var s=void 0;return ReactDOM.render(React.createElement(r,_extends({},t,{ref:e})),document.createElement("div")),s}}}();