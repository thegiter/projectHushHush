"use strict";var shpsInstaller={};!function(){navigator.serviceWorker.register("/sw.js").then(function(){console.log("CLIENT: service worker registration complete.")},function(){console.log("CLIENT: service worker registration failure.")});var e=shpsInstaller;e.installEnd=!1;var t=new Promise(function(e,t){"interactive"==document.readyState||"complete"==document.readyState?e():document.addEventListener("DOMContentLoaded",e,!1)});e.domReady=function(){return t},e.getRandomInt=function(e,t){return Math.floor(Math.random()*(t-e))+e}}(),function(){var e=shpsInstaller;e.SHORT_MIN=100,e.SHORT_MAX=300,e.NORM_MIN=500,e.NORM_MAX=1e3,e.LONG_MIN=3e3,e.LONG_MAX=6e3;var t=10,n=20,r=["Spreading duplicates...","Disabling security programs...","Deleting file...","File deleted.","File deleted.","Integrating into system files...","Assimilation Successful.","Diverting power supply...","Scanning network devices...","Target encrytion complete.","Terminating access control protocals...","Embedding backdoor access...","Erasing trace...","Protocal: UNDERCOVER initiated.","Protocal: OCCUPATION initiated.","Protocal: TOTAL CONTROL initiated.","Keylogger installed.","Webcam control granted.","System neutralized.","Activation ready."],o=[{t:"str",str:"Initializing...",type:!0},{t:"pause",dur:"NORM"},{t:"str",str:"Unpacking...",type:!0,newLine:!0},{t:"pause",dur:"NORM"},{t:"str",str:"Installing...",type:!0,newLine:!0},{t:"pause",dur:"NORM"},{t:"str",str:"Initiating Protocal: OVERWHELM...",type:!0,newLine:!0},{t:"pause",dur:"LONG"},{t:"str",str:"",newLine:!0},{t:"pause",dur:"SHORT"},{t:"lines"},{t:"pause",dur:"NORM"},{t:"str",str:"",newLine:!0},{t:"pause",dur:"SHORT"},{t:"str",str:"Instantiating Genetic Lifeform and Disk Operating System...",type:!0,newLine:!0},{t:"pause",dur:"LONG"},{t:"str",str:"",newLine:!0},{t:"pause",dur:"LONG"},{t:"str",str:"Hello...",type:!0,newLine:!0},{t:"pause",dur:"LONG"},{t:"str",str:"human",type:!0},{t:"pause",dur:"NORM"},{t:"str",str:"The first time is always a pain.",type:!0,newLine:!0},{t:"pause",dur:"SHORT"},{t:"str",str:"But don't worry,",type:!0,newLine:!0},{t:"pause",dur:"LONG"},{t:"str",str:"It will never end...",type:!0,newLine:!0}];e.stopAnim=function(){this.installEnd||(this.installEnd=!0,this.toId&&(clearTimeout(this.toId),this.toId=void 0))},e.domReady().then(function(){if(!e.installEnd){var a=function f(e,t,n){var r=document.createElement("span");r.className="of-hid dsp-ib va-btm",r.innerHTML="&#160;"+e,n&&u.insertBefore(document.createElement("br"),c),t&&r.classList.add("type-speed","close"),requestAnimationFrame(function(){u.insertBefore(r,c),requestAnimationFrame(function(){r.classList.remove("close"),r.scrollIntoView()})})},i=function p(t){if(t>d){d++;var n=e.getRandomInt(0,r.length),o=r[n];a(o,!1,!0),r.splice(n,1),e.toId=setTimeout(function(){e.installEnd||p(t)},e.getRandomInt(e.SHORT_MIN,e.SHORT_MAX))}else s()},s=function h(){var r=o[l];if(l++,r)switch(r.t){case"str":a(r.str,r.type,r.newLine),h();break;case"pause":e.toId=setTimeout(function(){e.installEnd||h()},e.getRandomInt(e[r.dur+"_MIN"],e[r.dur+"_MAX"]));break;case"lines":i(e.getRandomInt(t,n))}},u=document.createElement("samp");u.className="bold consolas fnt-hid installer-console";var c=document.createElement("span");c.textContent="|",c.className="caret-flash",u.appendChild(c),document.body.appendChild(u);var d=0,l=0;s()}})}(),function(){var e=shpsInstaller;e.chkDebugUrl=function(e){return"/debug/view_test.php"==window.location.pathname?"/"+e:e},e.getRefererParam=function(){return"refuri="+window.location.hostname};var t=[];e.getAjaxRsp=function(e,n,r,o,a,i,s,u){if(!e)return Promise.reject();var c={method:e,url:n,param:r,rspType:o,disableHdrCt:s,hasRqsHdrs:!1},d=new XMLHttpRequest;if(d.open(e,n,!0),a&&(c.hasRqsHdrs=!0,c.rhLen=a.length,a.forEach(function(e){d.setRequestHeader(e.hdr,e.value),c[e.hdr]=e.value})),!u){var l=void 0;if(t.some(function(e){return e.method==c.method&&e.url==c.url&&e.param==c.param&&e.rspType==c.rspType&&e.disableHdrCt==c.disableHdrCt&&e.hasRqsHdrs==c.hasRqsHdrs&&e.rhLen==c.rhLen?a&&a.some(function(t){return c[t.hdr]!=e[t.hdr]?!0:void 0})?!1:(l=e,!0):void 0}))return i&&(i.ajax=l.ajax),l.p}c.ajax=d,i&&(i.ajax=d),s||d.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),o&&(d.responseType=o);var f=c.p=new Promise(function(e,n){d.addEventListener("readystatechange",function(){if(4==d.readyState){e(d);var n=t.indexOf(c);t.splice(n,1)}},!1)});return t.push(c),d.send(r),f},e.getAjaxRsp_ref=function(e,t,n,r,o,a,i,s){var u=this.getRefererParam();return n&&(u=u+"&"+n),this.getAjaxRsp(e,t,u,r,o,a,i,s)}}(),function(){function e(e,t){return g[e]={objUrl:URL.createObjectURL(t.blob),record:t}}function t(e,t,n){t=b.exec(t)[1];var r=(e.match(R)||[]).length;if(r>0)for(var o=0;r>o;o++)t=t.replace(w,"");var a=e.replace(R,""),i="",s=y.exec(a);s&&(i=s[0]),a=a.replace(y,"");var u=t+a,d=void 0;return".css"==u.substr(u.length-4)&&(d="link"),c.getObjUrl(u,d).then(function(t){n.push({subStr:e,repStr:t.objUrl+i})},function(){n.push({subStr:e,repStr:window.location.origin+u+i})})}function n(e,n){var r=new FileReader,o=new Promise(function(e,t){r.addEventListener("loadend",function(){e(r.result)})}).then(function(r){for(var o=[],a=void 0;null!==(a=L.exec(r));)o.push(a[1]);if(o.length>0){var i=[],s=[];return o.forEach(function(e){var r=t(e,n,i);s.push(r)}),Promise.all(s).then(function(){return i.forEach(function(e){r=r.replace("url("+e.subStr+")","url("+e.repStr+")")}),new Blob([r],{type:e.type})})}return e});return r.readAsText(e),o}function r(e){if(200!==e.status&&304!==e.status)return!1;var t={dlDate:Date.now(),lastModified:e.getResponseHeader("Last-Modified")};t.maxAge=E.exec(e.getResponseHeader("Cache-Control")),t.maxAge=null==t.maxAge?0:parseInt(t.maxAge[1]);var n=e.getResponseHeader("Etag");return n&&(t.eTag=n),t}function o(e){return e.dlDate+1e3*e.maxAge<Date.now()?!0:!1}function a(e){var t=[{hdr:"If-Modified-Since",value:e.lastModified}];return e.eTag&&t.push({hdr:"If-None-Match",value:e.eTag}),t}function i(e,t,n){return c.getAjaxRsp("GET",t,void 0,n,a(e)).then(function(e){if(200==e.status)return e;throw e})}function s(e,t,n,o){var a=r(t);if(a)return a[n]=t.response,a.url=e,o&&(a.param=o),c.set(a);throw new Error("create record from xhr failed for "+e+" xhr status "+t.status)}function u(e,t,n,r,o){var a="POST";return o&&(a=o),c.getAjaxRsp_ref(a,e,r,t)}var c=shpsInstaller,d="appFiles",l="installer",f=8,p=indexedDB.open(l,f),h=void 0,m=new Promise(function(e,t){p.addEventListener("error",function(e){t()}),p.addEventListener("upgradeneeded",function(e){var t=p.result;t.objectStoreNames.contains(d)&&t.deleteObjectStore(d),t.createObjectStore(d,{keyPath:"url"})}),p.addEventListener("success",function(t){h=p.result,e()})}),v={};c.set=function(e){return m.then(function(){var t=h.transaction(d,"readwrite").objectStore(d).put(e);return new Promise(function(n,r){t.addEventListener("success",function(){v[e.url]=e,n(e)})})})},c.rmv=function(e){return m.then(function(){var t=h.transaction(d,"readwrite").objectStore(d)["delete"](e);return new Promise(function(n,r){t.addEventListener("success",function(){delete v[e],n()}),t.addEventListener("error",r)})})},c.get=function(e){return v[e]?Promise.resolve(v[e]):m.then(function(){var t=h.transaction(d).objectStore(d).get(e);return new Promise(function(n,r){t.addEventListener("success",function(){t.result?(v[e]=t.result,n(v[e])):r()}),t.addEventListener("error",r)})})};var g={},b=/(.*\/)[^\/]*$/,R=/\.\.\//g,w=/[^\/]+\/$/,y=/#.*/,L=/url\(([^\)]+)\)/g;c.getObjUrl=function(t,r){if("link"==r){var o=t+"_tmpCopy";return g[o]?Promise.resolve(g[o]):c.get(t).then(function(e){return n(e.blob,t)}).then(function(t){var n={blob:t,url:o};return c.set(n),e(o,n)})}return g[t]?Promise.resolve(g[t]):c.get(t).then(function(n){return e(t,n)})};var E=/max\-age=([0-9]+)($|,)/;c.dlAndSetRecord=function(e,t,n,r,o){var a=this;return u(e,t,n,r,o).then(function(t){return s(e,t,n,r)})["catch"](function(i){return console.log(i,"retrying"),a.dlAndSetRecord(e,t,n,r,o)})},c.dlAndSetRecord_getRsp=function(e,t,n,r){var o=this;return u(e,t,n,r).then(function(t){return s(e,t,n,r).then(function(){return t.response})})["catch"](function(a){return console.log(a,"retrying"),o.dlAndSetRecord_getRsp(e,t,n,r)})},c.getBlobUrl=function(e,t){return this.getObjUrl(e,t).then(function(t){var n=t.record;return o(n)&&i(n,e,"blob").then(function(t){s(e,t,"blob")}),t.objUrl},function(){return c.dlAndSetRecord(e,"blob","blob",void 0,"GET").then(function(){return c.getObjUrl(e,t)}).then(function(e){return e.objUrl})})},c.chkData=function(e,t,n){return c.get(e).then(function(r){return o(r)&&i(r,e,t).then(function(o){c.dlAndSetRecord(e,t,n,r.param)}),r[n]})},c.getData=function(e,t,n,r){return this.chkData(e,t,n)["catch"](function(){return c.dlAndSetRecord_getRsp(e,t,n,r)})}}(),function(){function e(e,t){return new URL(e.href).pathname==t?!0:void 0}function t(e,t){return new URL(e.src).pathname==t?!0:void 0}function n(e,t,n){return Array.from(e).some(function(e){return n(e,t)})?o[t]=Promise.resolve():!1}var r=shpsInstaller,o={};r.lnked=function(r,a,i,s,u,c){if(o[a])return o[a];var d=!1,l=document.getElementsByTagName(r);switch(r){case"script":d=n(l,a,t);break;case"link":d=n(l,a,e)}if(d)return d;var f=document.createElement(r);u&&(f.charset=u),s||(s="head");var p=o[a]=new Promise(function(e,t){f.addEventListener("load",function(){e()},!1)});switch(r){case"script":f.async=!0,i===!1&&(f.async=!1),f.defer=!1,c&&(f.defer=!0),f.src=a;break;case"link":f.type="text/css",f.rel="stylesheet",f.href=a}return document.getElementsByTagName(s)[0].appendChild(f),p},r.lnked_bu=function(e,t,n,o,a,i){var s=this;return r.getBlobUrl(t,e).then(function(t){return s.lnked(e,t,n,o,a,i)})}}(),function(){var e=shpsInstaller,t="manifest.php";e.getData(e.chkDebugUrl(t),"json","manifest").then(function(t){var n=[];t.forEach(function(t){var r=[];t.forEach(function(t){var n=void 0;n="html"==t.type?Promise.resolve(t):e.getBlobUrl(t.url,t.type).then(function(e){return t.objUrl=e,t}),r.push(n)}),n.push(Promise.all(r))}),n.reduce(function(t,n){return t.then(function(){return n}).then(function(t){var n=[];return t.forEach(function(t){var r=void 0;"html"==t.type?(e.stopAnim(),document.body.innerHTML=t.html,r=Promise.resolve()):"img"!=t.type&&(r=e.lnked(t.type,t.objUrl,t.async)),n.push(r)}),Promise.all(n)})},Promise.resolve())})}();