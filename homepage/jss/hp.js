!function(){function e(t,n,i,o){var s=document.createElement("ul");mdf_cls(s,"add","no-style no-indent");var a=document.createElement("span");mdf_cls(a,"add","pointer"),forEachObjProp(t,function(t,n){var d=document.createElement("li"),r=document.createElement("div");mdf_cls(r,"add","con-marker"),d.appendChild(r);var c=document.createElement("a");if(c.href=t.href,c.textContent=n,mdf_cls(c,"add","va-mid"),d.appendChild(c),"ctt"==t.type)mdf_cls(c,"add","ctt");else if("cat"==t.type&&(mdf_cls(c,"add","cat"),t.smi)){var l=document.createElement("span");l.innerHTML="&#8901;",mdf_cls(l,"add","va-mid sep"),d.appendChild(l);var m=document.createElement("button");m.title="Show sub-menus.",m.type="button",m.innerHTML="&#8811;",mdf_cls(m,"add","va-mid arrow no-style clickable");var g=e(t.smi,n,i,o+1);m.addEventListener("click",function(){var e=g.parentNode;e.insertBefore(g,e.childNodes[0]),i.focus(o+1),d.insertBefore(a,d.childNodes[0])},!1),d.appendChild(m)}s.appendChild(d)});var d=document.createElement("span");return d.textContent="~~ "+n+" ~~",s.appendChild(d),i.addToPane(o,s),s}var t="hp-bd",n="hp-bigpic-base",o="hp-bar",s=shpsCmm.iCMgr,a=new ttlElmOnload(t);Promise.all([s.getObjUrl("/homepage/imgs/bg_img.jpg","img"),s.getObjUrl("/homepage/csss/hp.css","link")]).then(function(e){a.addImgs(e[0].objUrl,[""]),a.addCss(e[1].objUrl),a.useDefault=!1,a.start()},function(){console.log("get homepage cnr obj url rejected, homepage cnr items does not exist in indexed db.")});var d=new ttlElmOnload(n);Promise.all([s.getObjUrl("/homepage/imgs/base_ptn.jpg","img"),s.getObjUrl("/homepage/imgs/main_pic.jpg","img"),s.getObjUrl("/homepage/imgs/abstract.png","img")]).then(function(e){d.addImgs(e[0].objUrl,[""]),d.addImgs(e[1].objUrl,[""]),d.addImgs(e[2].objUrl,[""]),d.useDefault=!1,d.start()},function(){console.log("get homepage bigpic obj url rejected, homepage bigpics do not exist in indexed db.")});var r=new ttlElmOnload(o);s.getBlobUrl("/shared/menu/btn/jss/btn.js","script").then(function(e){r.addScript(e),r.useDefault=!1,r.start()}),shpsAjax.hooks.homepage=function(e){function s(){m.addEventListener("transitionend",function e(t){return console.log("cnr fadeing transition end"),t.target!=this?!1:(console.log("transitionend is triggered on the container"),t.target.removeEventListener(t.type,e),E(),void 0)},!1),mdf_cls(m,"remove","dsp-non"),m.offsetHeight,l(),mdf_cls(m,"remove","opa-0")}shpsAjax.pgMgr.cache[e].obj={};var c=shpsAjax.pgMgr.cache[e].obj;c.lded=!1;var l,m,g,f,u,p=function(){},h=function(){},v=function(){},b=function(){function e(){u=document.getElementById(o),b=function(){f(),mdf_cls(u,"remove","hp-bar-in-trans"),u.offsetHeight,mdf_cls(u,"add","hp-bar-sdw-in-init"),mdf_cls(u,"remove","dsp-non"),u.offsetHeight,mdf_cls(u,"add","hp-bar-in-trans"),u.addEventListener("transitionend",function e(t){if(t.target!=this)return!1;t.target.removeEventListener(t.type,e),mdf_cls(u,"remove","hp-bar-sdw-in-init");var n=(m.scrollWidth-m.clientWidth)/2,i=m.clientWidth/2;n>i&&(n=i),transScroll(m,n,!0,1.5)},!1),mdf_cls(u,"remove","hp-bar-in-init")},p=function(){u.classList.add("dsp-non")},h=function(){u.classList.add("hp-bar-sdw-in-init","hp-bar-in-init")},v=function(){u.addEventListener("transitionend",function e(t){return t.target!=this?!1:(t.target.removeEventListener(t.type,e),p(),void 0)})},b()}r.lded?e():r.callback=e},E=function(){function e(){console.log("bigpic anim inited"),E=function(){g.style.left="0",setTimeout(b,1e3)},E()}console.log("bigpic intro triggered"),d.lded?(console.log("bigpic teo loaded"),e()):(console.log("bigpic teo not loaded"),d.callback=e)};c.intro=function(e){console.log("homepage intro");var t={cb:function(){e&&e.cb&&e.cb(),s()},cbTiming:"end"};shpsAjax.cpnMgr.operator.open("bg_basic",t)},c.exit=function(e){var t=function(){m.classList.add("dsp-non")};e&&e.instant?(t(),p()):(e&&e.cb&&"end"==e.cbTiming&&(t=function(){m.classList.add("dsp-non"),e.cb()}),m.addEventListener("transitionend",function n(e){return e.target!=this?!1:(e.target.removeEventListener(e.type,n),t(),void 0)}),v()),m.classList.add("opa-0"),g.style.removeProperty("left"),h()},c.onload=function(e){function o(){function o(){if(g.offsetHeight!=g.lastH){g.lastH=g.offsetHeight;var e=1.026851851851852*g.offsetHeight,t=g.offsetWidth-e;t>0?g.style.marginRight=t+"px":g.style.removeProperty("margin-right"),g.style.width=e+"px"}}function s(){m.offsetWidth!=m.lastW&&(m.lastW=m.offsetWidth,forEachNodeItem(a.children,function(e){e.children[0].style.maxWidth=m.lastW+"px"}))}m=document.getElementById(t),g=document.getElementById(n),g.lastH=0,optElmRszLsnr.add(g,o),m.lastW=0;var a=document.getElementById("hp-cnr");optElmRszLsnr.add(m,s),l=function(){l=function(){},o(),s()},shpsAjax.psdMenu.regFixed(function(e){m.style.backgroundPosition=e+"px",g.style.backgroundPosition=e+"px, center bottom, center top"}),f=function(){function e(e){s[e].state="open",a&&t(a),mdf_cls(s[e].btnVer,"add","ver-to-hor");var n=s[e].cnr,i=n.cloneNode(!0);mdf_cls(i,"add","vsb-hid pos-abs"),i.style.height="auto",n.parentNode.appendChild(i),n.addEventListener("transitionend",function(t){return t.target!=this?!1:(t.target.removeEventListener(t.type,arguments.callee),"open"==s[e].state&&(n.style.height="auto"),void 0)},!1),n.style.height=i.offsetHeight+"px",n.parentNode.removeChild(i),a=e}function t(e){s[e].state="close",mdf_cls(s[e].btnVer,"remove","ver-to-hor");var t=s[e].cnr;"auto"==t.style.height&&(t.style.height=t.offsetHeight+"px",t.offsetHeight),t.style.height="0",e==a&&(a=void 0)}function n(n){var i=this.dataset.index;"close"==s[i].state?e(i):t(i)}f=function(){};var o=document.getElementById("hp-menu").children,s=[],a;for(i=0;i<o.length;i++)s[i]={},s[i].btn=o[i].getElementsByClassName("expand-btn-cnr")[0].getElementsByTagName("button")[0],s[i].btn.dataset.index=i,s[i].btnVer=s[i].btn.getElementsByClassName("ver")[0],s[i].cnr=o[i].getElementsByClassName("sub-menu-cnr")[0],s[i].state="close",s[i].btn.addEventListener("click",n,!1);var d=document.getElementById("hp-menu-btn");menuBtnModule(d);var r=document.getElementById("hp-menu-resp"),c="closed",l="60vh";d.addEventListener("click",function(){"opening"==c?(c="closing",r.style.maxHeight==l&&(mdf_cls(r,"remove","hp-menu-resp-trans"),r.style.maxHeight=r.offsetHeight+"px",r.offsetHeight,mdf_cls(r,"add","hp-menu-resp-trans")),r.style.maxHeight="0"):(c="opening",r.style.maxHeight=l)},!1);var m=!1;u.addEventListener("click",function(){m=!0},!1);var g=new MouseEvent("click",{bubbles:!1,cancelable:!0});window.addEventListener("click",function(){m?m=!1:(a&&t(a),"opening"==c&&d.dispatchEvent(g))},!1)},e()}a.lded?o():a.callback=o}};var c="hp-menu",l=new ttlElmOnload(c);l.addScript("/shared/onenote_menu_cnr/jss/omc.js"),l.addScript("/shared/mis/jss/mis.js"),l.useDefault=!1,l.callback=function(){smiModule.onloadDo(function(t){for(var n=document.getElementById(c).children,i=0;i<n.length;i++){var o=n[i].children[0].textContent;if(t[o]){var s=n[i].getElementsByClassName("omc")[0],a=new omcModule(s,"50vh");e(t[o].smi,o,a,1),a.focus(1),mdf_cls(s,"remove","loading")}}})},l.start();var m="hp-menu-resp",g=new ttlElmOnload(m);g.addScript("/shared/onenote_menu_cnr/jss/omc.js"),g.addScript("/shared/mis/jss/mis.js"),g.useDefault=!1,g.callback=function(){smiModule.onloadDo(function(t){var n=document.getElementById(m).children[0],i=new omcModule(n,"40vh");e(t,"SHPS",i,1),i.focus(1),mdf_cls(n,"remove","loading")})},g.start()}();