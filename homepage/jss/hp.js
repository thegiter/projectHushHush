"use strict";!function(){var e="homepage",t="hp-bd",n="hp-bigpic-base",s="hp-bar",i="hp-menu",o="hp-menu-resp",a="/shared/modules/menu/btn/",r="/shared/modules/onenote_menu/",d="/shared/modules/menu_items/",c="/shared/modules/ftr/info_lnks/",l="/shared/modules/tooltips/simple/",m="/shared/modules/js_frameworks/anim/",u="/shared/modules/ldg_signs/td_bars/",h="ftr-info-lnks",f=shpsCmm.moduleMgr,p=shpsCmm.elmOnldr,v=shpsCmm.util,g=shpsCmm.evtMgr,y=!1,E=new shpsCmm.TtlElmOnldr;E.addImgs("/homepage/imgs//*replace*/",["base_ptn.jpg","main_pic.jpg","abstract.png"],!0);var b=f.get(a,!0),L=void 0,x=void 0,C=f.get(u,!0).then(function(e){var t=e.obj.ldgTdBarsFactory;L=t.createObj(),x=t.createObj()});shpsAjax.hooks[e]=function(e){var a=shpsAjax.pgMgr.cache[e].obj={};a.lded=!1;var u=void 0,p=void 0,x=void 0,w=void 0,B=function A(){},H=function I(){},j=function W(){},k=function M(){var e=void 0;f.get(m).then(function(t){e=t.obj.transScrl}),new v.AnimFramePromise(function(){x.classList.remove("dsp-non"),x.addEventListener("transitionend",function t(n){if(n.target!=this)return!1;if(n.target.removeEventListener(n.type,t),x.classList.remove("hp-bar-sdw-in-init"),e){var s=(u.scrollWidth-u.clientWidth)/2,i=u.clientWidth/2;s>i&&(s=i),e(u,s,!0,1.5)}},!1)}).then(function(){x.classList.remove("hp-bar-in-init")})};a.intro=function(e){var t={cb:function n(){e&&e.cb&&e.cb(),new Promise(function(e){u.addEventListener("transitionend",function t(n){return n.target!=this?!1:(n.target.removeEventListener(n.type,t),e(),void 0)},!1)}).then(function(){return E.lded()}).then(function(){y||(y=!0,L&&p.parentNode.removeChild(L.getElm())),p.style.left="0",setTimeout(k,1e3)}),new v.AnimFramePromise(function(){u.classList.remove("dsp-non")}).then(function(){w(),u.classList.remove("opa-0")})},cbTiming:"end"};shpsAjax.cpnMgr.operator.open("bg_basic",t)},a.exit=function(e){var t=function n(){u.classList.add("dsp-non")};e&&e.instant?(t(),B()):(e&&e.cb&&"end"==e.cbTiming&&(t=function s(){u.classList.add("dsp-non"),e.cb()}),u.addEventListener("transitionend",function i(e){return e.target!=this?!1:(e.target.removeEventListener(e.type,i),t(),void 0)}),j()),u.classList.add("opa-0"),p.style.removeProperty("left"),H()};var P=function T(){},N=function _(){};a.swapOut=function(){N()},a.swapIn=function(){P()},a.onload=function(e){function a(){if(p.offsetHeight!=p.lastH){p.lastH=p.offsetHeight;var e=1.026851851851852*p.offsetHeight,t=p.offsetWidth-e;t>0?p.style.marginRight=t+"px":p.style.removeProperty("margin-right"),p.style.width=e+"px"}}function m(){u.offsetWidth!=u.lastW&&(u.lastW=u.offsetWidth,Array.from(W.children).forEach(function(e){e.children[0].style.maxWidth=u.lastW+"px"}))}function k(e){T[e].state="close",T[e].btnVer.classList.remove("ver-to-hor");var t=T[e].cnr;new v.AnimFramePromise(function(){"auto"==t.style.height&&(t.style.height=t.offsetHeight+"px")}).then(function(){t.style.height="0"}),e==_&&(_=void 0)}function A(e){T[e].state="open",_&&k(_),T[e].btnVer.classList.add("ver-to-hor");var t=T[e].cnr,n=t.cloneNode(!0);n.classList.add("vsb-hid","pos-abs"),n.style.height="auto",t.parentNode.appendChild(n),t.addEventListener("transitionend",function s(n){return n.target!=this?!1:(n.target.removeEventListener(n.type,s),"open"==T[e].state&&(t.style.height="auto"),void 0)},!1),t.style.height=n.offsetHeight+"px",t.parentNode.removeChild(n),_=e}function I(e){var t=this.dataset.index;"close"==T[t].state?A(t):k(t)}u=document.getElementById(t),p=document.getElementById(n),x=document.getElementById(s),p.lastH=0,g.addEvtLsnr(p,"optElmRsz",a),u.lastW=0;var W=document.getElementById("hp-cnr");g.addEvtLsnr(u,"optElmRsz",m),w=function F(){w=function e(){},a(),m()},shpsAjax.psdSidebar.regFixed(function(e){u.style.backgroundPosition=e+"px",p.style.backgroundPosition=e+"px, center bottom, center top"}),C.then(function(){y||p.parentNode.appendChild(L.getElm())}),B=function O(){x.classList.add("dsp-non")},H=function S(){x.classList.add("hp-bar-sdw-in-init","hp-bar-in-init")},j=function R(){x.addEventListener("transitionend",function e(t){return t.target!=this?!1:(t.target.removeEventListener(t.type,e),B(),void 0)})};var M=document.getElementById("hp-menu").children,T=[],_=void 0;Array.from(M).forEach(function(e,t){var n=T[t]={},s=n.btn=e.getElementsByClassName("expand-btn-cnr")[0].getElementsByTagName("button")[0];s.dataset.index=t,n.btnVer=s.getElementsByClassName("ver")[0],n.cnr=e.getElementsByClassName("sub-menu-cnr")[0],n.state="close",s.addEventListener("click",I,!1)}),b.then(function(e){function t(){a?a=!1:(_&&k(_),"opening"==i&&g.triggerOn(n,"click",!1))}var n=document.getElementById("hp-menu-btn");new e.obj.MenuBtn(n);var s=document.getElementById("hp-menu-resp"),i="closed",o="60vh";n.addEventListener("click",function(){"opening"==i?(i="closing",s.style.maxHeight==o?new v.AnimFramePromise(function(){s.classList.remove("hp-menu-resp-trans"),s.style.maxHeight=s.offsetHeight+"px"}).then(function(){s.classList.add("hp-menu-resp-trans"),s.style.maxHeight="0"}):s.style.maxHeight="0"):(i="opening",s.style.maxHeight=o)},!1);var a=!1;x.addEventListener("click",function(){a=!0},!1),P=function r(){window.addEventListener("click",t,!1)},N=function d(){window.removeEventListener("click",t)},P()}),Promise.all([E.lded(),b]).then(function(){return Promise.all([f.get(r,!0),f.get(d,!0)])}).then(function(e){function t(e,n,s,i){var o=document.createElement("ul");o.classList.add("no-style","no-indent");var a=document.createElement("span");a.classList.add("pointer"),v.forEachObjProp(e,function(e,n){var r=document.createElement("li"),d=document.createElement("div");d.classList.add("con-marker"),r.appendChild(d);var c=document.createElement("a");if(c.href=e.href,c.textContent=n,c.classList.add("va-mid"),r.appendChild(c),"ctt"==e.type)c.classList.add("ctt");else if("cat"==e.type&&(c.classList.add("cat"),e.smi)){var l=document.createElement("span");l.innerHTML="&#8901;",l.classList.add("va-mid","sep"),r.appendChild(l);var m=document.createElement("button");m.title="Show sub-menus.",m.type="button",m.innerHTML="&#8811;",m.classList.add("va-mid","arrow","no-style","clickable");var u=t(e.smi,n,s,i+1);m.addEventListener("click",function(){var e=u.parentNode;e.insertBefore(u,e.childNodes[0]),s.focus(i+1),r.insertBefore(a,r.childNodes[0])},!1),r.appendChild(m)}o.appendChild(r)});var r=document.createElement("span");return r.textContent="~~ "+n+" ~~",o.appendChild(r),s.addToPane(i,o),o}for(var n=e[0].obj,s=e[1].obj,a=s.getItems(),r=document.getElementById(i).children,d=0;d<r.length;d++){var c=r[d].children[0].textContent;if(a[c]){var l=r[d].getElementsByClassName("omc")[0],m=new n.onenoteMenu(l,"50vh");t(a[c].smi,c,m,1),m.focus(1),l.classList.remove("loading")}}var u=document.getElementById(o).children[0],h=new n.onenoteMenu(u,"40vh");t(a,"SHPS",h,1),h.focus(1),u.classList.remove("loading")}).then(function(){return f.get(c)}).then(function(){Array.from(x.getElementsByClassName(h)).forEach(function(e){new v.AnimFramePromise(function(){e.classList.remove("vsb-hid")}).then(function(){e.classList.remove("opa-0")})}),f.get(l)}),e()}}}();