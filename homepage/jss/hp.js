!function(){const e="hp-bd",t="hp-bigpic-base",n="hp-bar",o="hp-menu",s="hp-menu-resp",d="/shared/modules/menu/btn/",a="/shared/modules/onenote_menu/",r="/shared/modules/menu_items/",c="/shared/modules/ftr/info_lnks/",l="shared/modules/tooltips/simple/",m="ftr-info-lnks";var f=shpsCmm.elmOnldr,h=shpsCmm.moduleMgr,u=new f.ttlElmOnldr;u.addElm(e),u.addBuImg("/homepage/imgs/bg_img.jpg"),u.addBuImgs("/homepage/imgs//*replace*/",["base_ptn.jpg","main_pic.jpg","abstract.png"]),u.addBuCss("/homepage/csss/hp.css");var p=Promise.all([f.elmLded(n),h.get(d,!0)]);shpsAjax.hooks.homepage=function(f){shpsAjax.pgMgr.cache[f].obj={};var g=shpsAjax.pgMgr.cache[f].obj;g.lded=!1;var v,b,E,y,_,L=function(){},x=function(){},H=function(){},B=function(){p.then(function(){mdf_cls(E,"remove","hp-bar-in-trans"),E.offsetHeight,mdf_cls(E,"add","hp-bar-sdw-in-init"),mdf_cls(E,"remove","dsp-non"),E.offsetHeight,mdf_cls(E,"add","hp-bar-in-trans"),E.addEventListener("transitionend",function e(t){if(t.target!=this)return!1;t.target.removeEventListener(t.type,e),mdf_cls(E,"remove","hp-bar-sdw-in-init");var n=(v.scrollWidth-v.clientWidth)/2,i=v.clientWidth/2;n>i&&(n=i),transScroll(v,n,!0,1.5)},!1),mdf_cls(E,"remove","hp-bar-in-init")})};g.intro=function(e){var t={cb:function(){e&&e.cb&&e.cb(),new Promise(function(e){console.log("bg introed, triggering homepage intro"),v.addEventListener("transitionend",function t(n){return console.log("cnr fadeing transition end"),n.target!=this?!1:(console.log("transitionend is triggered on the container"),n.target.removeEventListener(n.type,t),e(),void 0)},!1),mdf_cls(v,"remove","dsp-non"),v.offsetHeight,y(),mdf_cls(v,"remove","opa-0")}).then(function(){console.log("bigpic anim inited"),b.style.left="0",setTimeout(B,1e3)})},cbTiming:"end"};shpsAjax.cpnMgr.operator.open("bg_basic",t)},g.exit=function(e){var t=function(){v.classList.add("dsp-non")};e&&e.instant?(t(),L()):(e&&e.cb&&"end"==e.cbTiming&&(t=function(){v.classList.add("dsp-non"),e.cb()}),v.addEventListener("transitionend",function n(e){return e.target!=this?!1:(e.target.removeEventListener(e.type,n),t(),void 0)}),H()),v.classList.add("opa-0"),b.style.removeProperty("left"),x()};var C=function(){},w=function(){};g.swapOut=function(){w()},g.swapIn=function(){C()},g.onload=function(f){u.lded().then(function(){function n(){if(b.offsetHeight!=b.lastH){b.lastH=b.offsetHeight;var e=1.026851851851852*b.offsetHeight,t=b.offsetWidth-e;t>0?b.style.marginRight=t+"px":b.style.removeProperty("margin-right"),b.style.width=e+"px"}}function i(){v.offsetWidth!=v.lastW&&(v.lastW=v.offsetWidth,forEachNodeItem(o.children,function(e){e.children[0].style.maxWidth=v.lastW+"px"}))}console.log("hp cnr teo lded"),v=document.getElementById(e),b=document.getElementById(t),b.lastH=0,optElmRszLsnr.add(b,n),v.lastW=0;var o=document.getElementById("hp-cnr");optElmRszLsnr.add(v,i),y=function(){y=function(){},n(),i()},shpsAjax.psdMenu.regFixed(function(e){v.style.backgroundPosition=e+"px",b.style.backgroundPosition=e+"px, center bottom, center top"}),f()}),p.then(function(){function e(e){r[e].state="open",c&&t(c),mdf_cls(r[e].btnVer,"add","ver-to-hor");var n=r[e].cnr,i=n.cloneNode(!0);mdf_cls(i,"add","vsb-hid pos-abs"),i.style.height="auto",n.parentNode.appendChild(i),n.addEventListener("transitionend",function(t){return t.target!=this?!1:(t.target.removeEventListener(t.type,arguments.callee),"open"==r[e].state&&(n.style.height="auto"),void 0)},!1),n.style.height=i.offsetHeight+"px",n.parentNode.removeChild(i),c=e}function t(e){r[e].state="close",mdf_cls(r[e].btnVer,"remove","ver-to-hor");var t=r[e].cnr;"auto"==t.style.height&&(t.style.height=t.offsetHeight+"px",t.offsetHeight),t.style.height="0",e==c&&(c=void 0)}function o(n){var i=this.dataset.index;"close"==r[i].state?e(i):t(i)}function s(){p?p=!1:(c&&t(c),"opening"==f&&l.dispatchEvent(g))}E=document.getElementById(n),L=function(){E.classList.add("dsp-non")},x=function(){E.classList.add("hp-bar-sdw-in-init","hp-bar-in-init")},H=function(){E.addEventListener("transitionend",function e(t){return t.target!=this?!1:(t.target.removeEventListener(t.type,e),L(),void 0)})};var a=document.getElementById("hp-menu").children,r=[],c;for(i=0;i<a.length;i++)r[i]={},r[i].btn=a[i].getElementsByClassName("expand-btn-cnr")[0].getElementsByTagName("button")[0],r[i].btn.dataset.index=i,r[i].btnVer=r[i].btn.getElementsByClassName("ver")[0],r[i].cnr=a[i].getElementsByClassName("sub-menu-cnr")[0],r[i].state="close",r[i].btn.addEventListener("click",o,!1);var l=document.getElementById("hp-menu-btn");h.get(d).then(function(e){new e.obj.menuBtn(l)});var m=document.getElementById("hp-menu-resp"),f="closed",u="60vh";l.addEventListener("click",function(){"opening"==f?(f="closing",m.style.maxHeight==u&&(mdf_cls(m,"remove","hp-menu-resp-trans"),m.style.maxHeight=m.offsetHeight+"px",m.offsetHeight,mdf_cls(m,"add","hp-menu-resp-trans")),m.style.maxHeight="0"):(f="opening",m.style.maxHeight=u)},!1);var p=!1;E.addEventListener("click",function(){p=!0},!1);var g=new MouseEvent("click",{bubbles:!1,cancelable:!0});C=function(){window.addEventListener("click",s,!1)},w=function(){window.removeEventListener("click",s)},C()}),Promise.all([u.lded(),p]).then(function(){return Promise.all([h.get(a,!0),h.get(r,!0)])}).then(function(e){function t(e,n,i,o){var s=document.createElement("ul");mdf_cls(s,"add","no-style no-indent");var d=document.createElement("span");mdf_cls(d,"add","pointer"),forEachObjProp(e,function(e,n){var a=document.createElement("li"),r=document.createElement("div");mdf_cls(r,"add","con-marker"),a.appendChild(r);var c=document.createElement("a");if(c.href=e.href,c.textContent=n,mdf_cls(c,"add","va-mid"),a.appendChild(c),"ctt"==e.type)mdf_cls(c,"add","ctt");else if("cat"==e.type&&(mdf_cls(c,"add","cat"),e.smi)){var l=document.createElement("span");l.innerHTML="&#8901;",mdf_cls(l,"add","va-mid sep"),a.appendChild(l);var m=document.createElement("button");m.title="Show sub-menus.",m.type="button",m.innerHTML="&#8811;",mdf_cls(m,"add","va-mid arrow no-style clickable");var f=t(e.smi,n,i,o+1);m.addEventListener("click",function(){var e=f.parentNode;e.insertBefore(f,e.childNodes[0]),i.focus(o+1),a.insertBefore(d,a.childNodes[0])},!1),a.appendChild(m)}s.appendChild(a)});var a=document.createElement("span");return a.textContent="~~ "+n+" ~~",s.appendChild(a),i.addToPane(o,s),s}for(var n=e[0].obj,i=e[1].obj,d=i.getItems(),a=document.getElementById(o).children,r=0;r<a.length;r++){var c=a[r].children[0].textContent;if(d[c]){var l=a[r].getElementsByClassName("omc")[0],m=new n.onenoteMenu(l,"50vh");t(d[c].smi,c,m,1),m.focus(1),mdf_cls(l,"remove","loading")}}var f=document.getElementById(s).children[0],h=new n.onenoteMenu(f,"40vh");t(d,"SHPS",h,1),h.focus(1),mdf_cls(f,"remove","loading")}).then(function(){return h.get(c)}).then(function(){forEachNodeItem(E.getElementsByClassName(m),function(e){e.classList.remove("vsb-hid"),e.offsetHeight,e.classList.remove("opa-0")}),h.get(l)})}}}();