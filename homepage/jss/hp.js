"use strict";!function(){var e="homepage",t="hp-bd",n="hp-bigpic-base",i="hp-bar",s="hp-menu",o="hp-menu-resp",a="/shared/modules/menu/btn/",r="/shared/modules/onenote_menu/",c="/shared/modules/menu_items/",d="/shared/modules/ftr/info_lnks/",l="/shared/modules/tooltips/simple/",m="/shared/modules/js_frameworks/anim/",u="/shared/modules/ldg_signs/td_bars/",h="ftr-info-lnks",f=shpsCmm.moduleMgr,p=shpsCmm.elmOnldr,v=shpsCmm.util,g=shpsCmm.evtMgr,E=shpsCmm.domMgr,b=!1,y=new shpsCmm.TtlElmOnldr;y.addImgs("/homepage/imgs//*replace*/",["base_ptn.jpg","main_pic.jpg","abstract.png"],!0);var L=f.get(a,!0),x=void 0,C=void 0,w=f.get(u,!0).then(function(e){var t=e.obj.ldgTdBarsFactory;x=t.createObj(),C=t.createObj()});shpsAjax.hooks[e]=function(e){var a=shpsAjax.pgMgr.cache[e].obj={};a.lded=!1;var u=void 0,p=void 0,C=void 0,j=void 0,k=function I(){},B=function W(){},H=function M(){},P=function N(){var e=void 0;f.get(m).then(function(t){e=t.obj.transScrl}),new v.AnimFramePromise(function(){C.classList.remove("dsp-non"),C.addEventListener("transitionend",function t(n){if(n.target!=this)return!1;if(n.target.removeEventListener(n.type,t),C.classList.remove("hp-bar-sdw-in-init"),e){var i=(u.scrollWidth-u.clientWidth)/2,s=u.clientWidth/2;i>s&&(i=s),e(u,i,!0,1.5)}},!1)}).then(function(){C.classList.remove("hp-bar-in-init")})};a.intro=function(e){var t={cb:function n(){e&&e.cb&&e.cb(),new Promise(function(e){u.addEventListener("transitionend",function t(n){return n.target!=this?!1:(n.target.removeEventListener(n.type,t),e(),void 0)},!1)}).then(function(){return y.lded()}).then(function(){b||(b=!0,x&&p.parentNode.removeChild(x.getElm())),p.style.left="0",setTimeout(P,1e3)}),new v.AnimFramePromise(function(){u.classList.remove("dsp-non")}).then(function(){j(),u.classList.remove("opa-0")})},cbTiming:"end"};shpsAjax.cpnMgr.operator.open("bg_basic",t)},a.exit=function(e){var t=function n(){u.classList.add("dsp-non")};e&&e.instant?(t(),k()):(e&&e.cb&&"end"==e.cbTiming&&(t=function i(){u.classList.add("dsp-non"),e.cb()}),u.addEventListener("transitionend",function s(e){return e.target!=this?!1:(e.target.removeEventListener(e.type,s),t(),void 0)}),H()),u.classList.add("opa-0"),p.style.removeProperty("left"),B()};var A=function T(){},O=function _(){};a.swapOut=function(){O()},a.swapIn=function(){A()},a.onload=function(e){function a(){if(p.offsetHeight!=p.lastH){p.lastH=p.offsetHeight;var e=1.026851851851852*p.offsetHeight,t=p.offsetWidth-e;t>0?p.style.marginRight=t+"px":p.style.removeProperty("margin-right"),p.style.width=e+"px"}}function m(){u.offsetWidth!=u.lastW&&(u.lastW=u.offsetWidth,Array.from(M.children).forEach(function(e){e.children[0].style.maxWidth=u.lastW+"px"}))}function P(e){T[e].state="close";var t=T[e].cnr;new v.AnimFramePromise(function(){"auto"==t.style.height&&(t.style.height=t.offsetHeight+"px")}).then(function(){t.style.height="0"}),e==_&&(_=void 0)}function I(e){T[e].state="open",_&&g.triggerOn(T[_].btn,"click",!1);var t=T[e].cnr,n=E.getElmCloneDimension(t);t.addEventListener("transitionend",function i(n){return n.target!=this?!1:(n.target.removeEventListener(n.type,i),"open"==T[e].state&&(t.style.height="auto"),void 0)},!1),t.style.height=n.h+"px",_=e}function W(e){var t=this.dataset.index;"close"==T[t].state?I(t):P(t)}u=document.getElementById(t),p=document.getElementById(n),C=document.getElementById(i),p.lastH=0,g.addEvtLsnr(p,"optElmRsz",a),u.lastW=0;var M=document.getElementById("hp-cnr");g.addEvtLsnr(u,"optElmRsz",m),j=function F(){j=function e(){},a(),m()},shpsAjax.psdSidebar.addEvtLsnr("rsz",function(e){u.style.backgroundPosition=e+"px",p.style.backgroundPosition=e+"px, center bottom, center top"}),w.then(function(){b||p.parentNode.appendChild(x.getElm())}),k=function S(){C.classList.add("dsp-non")},B=function z(){C.classList.add("hp-bar-sdw-in-init","hp-bar-in-init")},H=function R(){C.addEventListener("transitionend",function e(t){return t.target!=this?!1:(t.target.removeEventListener(t.type,e),k(),void 0)})};var N=document.getElementById("hp-menu").children,T=[],_=void 0;L.then(function(e){function t(){c?c=!1:(_&&g.triggerOn(T[_].btn,"click",!1),"opening"==a&&g.triggerOn(o,"click",!1))}var n=e.obj.menuBtnFactory;Array.prototype.forEach.call(N,function(e,t){var i=T[t]={},s=e.getElementsByClassName("sep")[0],o=i.btn=n.createObj({clss:"no-style clickable va-mid"}).getElm();o.dataset.index=t,E.insertAft(o,s),i.cnr=e.getElementsByClassName("sub-menu-cnr")[0],i.state="close",o.addEventListener("click",W,!1)});var i=n.createObj({clss:"no-style clickable"}),s=document.getElementById("hp-menu-resp"),o=i.getElm(),a="closed",r="60vh";o.addEventListener("click",function(){"opening"==a?(a="closing",s.style.maxHeight==r?new v.AnimFramePromise(function(){s.classList.remove("hp-menu-resp-trans"),s.style.maxHeight=s.offsetHeight+"px"}).then(function(){s.classList.add("hp-menu-resp-trans"),s.style.maxHeight="0"}):s.style.maxHeight="0"):(a="opening",s.style.maxHeight=r)},!1),E.insertAft(o,s);var c=!1;C.addEventListener("click",function(){c=!0},!1),A=function d(){window.addEventListener("click",t,!1)},O=function l(){window.removeEventListener("click",t)},A()}),Promise.all([y.lded(),L]).then(function(){return Promise.all([f.get(r,!0),f.get(c,!0)])}).then(function(e){function t(e,n,i,s){var o=document.createElement("ul");o.classList.add("no-style","no-indent");var a=document.createElement("span");a.classList.add("pointer"),v.forEachObjProp(e,function(e,n){var r=document.createElement("li"),c=document.createElement("div");c.classList.add("con-marker"),r.appendChild(c);var d=document.createElement("a");if(d.href=e.href,d.textContent=n,d.classList.add("va-mid"),r.appendChild(d),"ctt"==e.type)d.classList.add("ctt");else if("cat"==e.type&&(d.classList.add("cat"),e.smi)){var l=document.createElement("span");l.innerHTML="&#8901;",l.classList.add("va-mid","sep"),r.appendChild(l);var m=document.createElement("button");m.title="Show sub-menus.",m.type="button",m.innerHTML="&#8811;",m.classList.add("va-mid","arrow","no-style","clickable");var u=t(e.smi,n,i,s+1);m.addEventListener("click",function(){var e=u.parentNode;e.insertBefore(u,e.childNodes[0]),i.focus(s+1),r.insertBefore(a,r.childNodes[0])},!1),r.appendChild(m)}o.appendChild(r)});var r=document.createElement("span");return r.textContent="~~ "+n+" ~~",o.appendChild(r),i.addToPane(s,o),o}for(var n=e[0].obj,i=e[1].obj,a=i.getItems(),r=document.getElementById(s).children,c=0;c<r.length;c++){var l=r[c].children[0].textContent;if(a[l]){var m=r[c].getElementsByClassName("omc")[0],u=new n.onenoteMenu(m,"50vh");t(a[l].smi,l,u,1),u.focus(1),m.classList.remove("loading")}}var h=document.getElementById(o).children[0],p=new n.onenoteMenu(h,"40vh");return t(a,"SHPS",p,1),p.focus(1),h.classList.remove("loading"),f.get(d)}).then(function(){return Array.from(C.getElementsByClassName(h)).forEach(function(e){new v.AnimFramePromise(function(){e.classList.remove("vsb-hid")}).then(function(){e.classList.remove("opa-0")})}),f.get(l)}).then(function(e){var t=e.obj.ttSimpleFactory;T.forEach(function(e){t.createObj(e.btn,{tooltip:"Toggle Submenu"})})}),e()}}}();